{
  "version": 3,
  "sources": ["../frontend-scripts/core/NetworkManager.ts", "../frontend-scripts/core/GameManager.ts", "../frontend-scripts/utils/dom.ts", "../frontend-scripts/components/Icon.ts", "../frontend-scripts/components/Toast.ts", "../frontend-scripts/scenes/LoginScene.ts", "../frontend-scripts/core/Env.ts", "../frontend-scripts/core/RealtimeClient.ts", "../frontend-scripts/components/Nav.ts", "../frontend-scripts/components/ResourceBar.ts", "../frontend-scripts/components/FloatText.ts", "../frontend-scripts/scenes/MainScene.ts", "../frontend-scripts/scenes/WarehouseScene.ts", "../frontend-scripts/scenes/PlunderScene.ts", "../frontend-scripts/scenes/ExchangeScene.ts", "../frontend-scripts/scenes/RankingScene.ts", "../frontend-scripts/styles/inject.ts", "../frontend-scripts/App.ts"],
  "sourcesContent": ["export class NetworkManager {\r\n  private static _instance: NetworkManager;\r\n  static get I(): NetworkManager { return this._instance ?? (this._instance = new NetworkManager()); }\r\n\r\n  private token: string | null = null;\r\n  setToken(t: string | null) { this.token = t; }\r\n\r\n  async request<T>(path: string, init?: RequestInit): Promise<T> {\r\n    const headers: any = { 'Content-Type': 'application/json', ...(init?.headers || {}) };\r\n    if (this.token) headers['Authorization'] = `Bearer ${this.token}`;\r\n    const res = await fetch(this.getBase() + path, { ...init, headers });\r\n    const json = await res.json();\r\n    if (!res.ok || json.code >= 400) throw new Error(json.message || 'Request Error');\r\n    return json.data as T;\r\n  }\r\n\r\n  getBase(): string {\r\n    return (window as any).__API_BASE__ || 'http://localhost:3000/api';\r\n  }\r\n}\r\n\r\n\r\n", "import { NetworkManager } from './NetworkManager';\r\n\r\nexport type Profile = { id: string; username: string; nickname: string; oreAmount: number; bbCoins: number };\r\n\r\nexport class GameManager {\r\n  private static _instance: GameManager;\r\n  static get I(): GameManager { return this._instance ?? (this._instance = new GameManager()); }\r\n\r\n  private profile: Profile | null = null;\r\n  getProfile(): Profile | null { return this.profile; }\r\n\r\n  async loginOrRegister(username: string, password: string): Promise<void> {\r\n    const nm = NetworkManager.I;\r\n    try {\r\n      const r = await nm.request<{ access_token: string; user: any }>('/auth/login', { method: 'POST', body: JSON.stringify({ username, password }) });\r\n      nm.setToken(r.access_token);\r\n    } catch {\r\n      const r = await NetworkManager.I.request<{ access_token: string; user: any }>('/auth/register', { method: 'POST', body: JSON.stringify({ username, password }) });\r\n      NetworkManager.I.setToken(r.access_token);\r\n    }\r\n    this.profile = await nm.request<Profile>('/user/profile');\r\n  }\r\n}\r\n\r\n\r\n", "export function html(template: string): HTMLElement {\r\n  const div = document.createElement('div');\r\n  div.innerHTML = template.trim();\r\n  return div.firstElementChild as HTMLElement;\r\n}\r\n\r\nexport function qs<T extends Element = HTMLElement>(root: ParentNode, sel: string): T {\r\n  const el = root.querySelector(sel) as T | null;\r\n  if (!el) throw new Error(`Missing element: ${sel}`);\r\n  return el as T;\r\n}\r\n\r\n\r\n", "import { html } from '../utils/dom';\n\nexport type IconName =\n  | 'home'\n  | 'warehouse'\n  | 'plunder'\n  | 'exchange'\n  | 'ranking'\n  | 'ore'\n  | 'coin'\n  | 'pick'\n  | 'refresh'\n  | 'play'\n  | 'stop'\n  | 'collect'\n  | 'wrench'\n  | 'shield'\n  | 'list'\n  | 'user'\n  | 'lock'\n  | 'eye'\n  | 'eye-off'\n  | 'sword'\n  | 'trophy'\n  | 'clock'\n  | 'bolt'\n  | 'trash'\n  | 'close'\n  | 'arrow-right'\n  | 'target';\n\nfunction grad(id: string) {\n  return `<defs>\n    <linearGradient id=\"${id}\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\n      <stop offset=\"0%\" stop-color=\"#7B2CF5\" />\n      <stop offset=\"100%\" stop-color=\"#2C89F5\" />\n    </linearGradient>\n  </defs>`;\n}\n\nfunction svgWrap(path: string, size = 18, cls = ''): HTMLElement {\n  const gid = 'ig-' + Math.random().toString(36).slice(2, 8);\n  const el = html(`<span class=\"icon ${cls}\" aria-hidden=\"true\">${\n    `<svg width=\"${size}\" height=\"${size}\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">${grad(gid)}${path.replaceAll('__GRAD__', `url(#${gid})`)}</svg>`\n  }</span>`);\n  return el;\n}\n\nexport function renderIcon(name: IconName, opts: { size?: number; className?: string } = {}) {\n  const size = opts.size ?? 18;\n  const cls = opts.className ?? '';\n  const stroke = 'stroke=\"__GRAD__\" stroke-width=\"1.7\" stroke-linecap=\"round\" stroke-linejoin=\"round\"';\n  const fill = 'fill=\"__GRAD__\"';\n\n  switch (name) {\n    case 'home':\n      return svgWrap(`<path d=\"M3 10.5L12 3l9 7.5\" ${stroke}/><path d=\"M5.5 9.5V21h13V9.5\" ${stroke}/><path d=\"M9.5 21v-6h5v6\" ${stroke}/>`, size, cls);\n    case 'warehouse':\n      return svgWrap(`<path d=\"M3 9l9-5 9 5v9.5c0 1-1 2-2 2H5c-1 0-2-1-2-2V9z\" ${stroke}/><path d=\"M7 12h10M7 16h10\" ${stroke}/>`, size, cls);\n    case 'plunder':\n      return svgWrap(`<path d=\"M4 20l7-7M13 13l7 7M9 5l6 6M15 5l-6 6\" ${stroke}/>`, size, cls);\n    case 'exchange':\n      return svgWrap(`<path d=\"M6 8h11l-3-3M18 16H7l3 3\" ${stroke}/>`, size, cls);\n    case 'ranking':\n      return svgWrap(`<path d=\"M8 14v6M12 10v10M16 6v14\" ${stroke}/><path d=\"M16 4.5a2 2 0 100-4 2 2 0 000 4z\" ${fill}/>` , size, cls);\n    case 'ore':\n      return svgWrap(`<path d=\"M12 3l6 4-2 8-4 6-4-6-2-8 6-4z\" ${stroke}/><path d=\"M12 3l-2 8 2 10 2-10-2-8z\" ${stroke}/>`, size, cls);\n    case 'coin':\n      return svgWrap(`<circle cx=\"12\" cy=\"12\" r=\"8.5\" ${stroke}/><path d=\"M8.5 12h7M10 9h4M10 15h4\" ${stroke}/>`, size, cls);\n    case 'pick':\n      return svgWrap(`<path d=\"M4 5c4-3 9-2 12 1M9 10l-5 5M9 10l2 2M7 12l2 2\" ${stroke}/><path d=\"M11 12l7 7\" ${stroke}/>`, size, cls);\n    case 'refresh':\n      return svgWrap(`<path d=\"M20 12a8 8 0 10-2.3 5.7\" ${stroke}/><path d=\"M20 12v6h-6\" ${stroke}/>`, size, cls);\n    case 'play':\n      return svgWrap(`<path d=\"M8 6v12l10-6-10-6z\" ${stroke}/>`, size, cls);\n    case 'stop':\n      return svgWrap(`<rect x=\"7\" y=\"7\" width=\"10\" height=\"10\" rx=\"2\" ${stroke}/>`, size, cls);\n    case 'collect':\n      return svgWrap(`<path d=\"M12 5v10\" ${stroke}/><path d=\"M8 11l4 4 4-4\" ${stroke}/><path d=\"M5 19h14\" ${stroke}/>`, size, cls);\n    case 'wrench':\n      return svgWrap(`<path d=\"M15.5 6a4.5 4.5 0 11-6.9 5.4L3 17l4.6-5.6A4.5 4.5 0 1115.5 6z\" ${stroke}/>`, size, cls);\n    case 'shield':\n      return svgWrap(`<path d=\"M12 3l8 3v6a10 10 0 01-8 9 10 10 0 01-8-9V6l8-3z\" ${stroke}/>`, size, cls);\n    case 'list':\n      return svgWrap(`<path d=\"M7 6h12M7 12h12M7 18h12\" ${stroke}/><path d=\"M4 6h.01M4 12h.01M4 18h.01\" ${stroke}/>`, size, cls);\n    case 'user':\n      return svgWrap(`<path d=\"M12 12a4 4 0 100-8 4 4 0 000 8z\" ${stroke}/><path d=\"M4 20a8 8 0 0116 0\" ${stroke}/>`, size, cls);\n    case 'lock':\n      return svgWrap(`<rect x=\"5\" y=\"10\" width=\"14\" height=\"10\" rx=\"2\" ${stroke}/><path d=\"M8 10V7a4 4 0 118 0v3\" ${stroke}/>`, size, cls);\n    case 'eye':\n      return svgWrap(`<path d=\"M2 12s4-7 10-7 10 7 10 7-4 7-10 7-10-7-10-7z\" ${stroke}/><circle cx=\"12\" cy=\"12\" r=\"3\" ${stroke}/>`, size, cls);\n    case 'eye-off':\n      return svgWrap(`<path d=\"M2 12s4-7 10-7 10 7 10 7-4 7-10 7-10-7-10-7z\" ${stroke}/><circle cx=\"12\" cy=\"12\" r=\"3\" ${stroke}/><path d=\"M3 3l18 18\" ${stroke}/>`, size, cls);\n    case 'sword':\n      return svgWrap(`<path d=\"M3 21l6-6M9 15l9-9 3 3-9 9M14 6l4 4\" ${stroke}/>`, size, cls);\n    case 'trophy':\n      return svgWrap(`<path d=\"M8 21h8M9 17h6M7 4h10v5a5 5 0 11-10 0V4z\" ${stroke}/><path d=\"M4 6h3v2a3 3 0 11-3-2zM20 6h-3v2a3 3 0 003-2z\" ${stroke}/>`, size, cls);\n    case 'clock':\n      return svgWrap(`<circle cx=\"12\" cy=\"12\" r=\"8.5\" ${stroke}/><path d=\"M12 7v6l4 2\" ${stroke}/>`, size, cls);\n    case 'bolt':\n      return svgWrap(`<path d=\"M13 2L6 14h5l-1 8 7-12h-5l1-8z\" ${stroke}/>`, size, cls);\n    case 'trash':\n      return svgWrap(`<path d=\"M4 7h16M9 7V5h6v2M7 7l1 13h8l1-13\" ${stroke}/>`, size, cls);\n    case 'close':\n      return svgWrap(`<path d=\"M6 6l12 12M6 18L18 6\" ${stroke}/>`, size, cls);\n    case 'arrow-right':\n      return svgWrap(`<path d=\"M4 12h14M12 5l7 7-7 7\" ${stroke}/>`, size, cls);\n    case 'target':\n      return svgWrap(`<circle cx=\"12\" cy=\"12\" r=\"8.5\" ${stroke}/><circle cx=\"12\" cy=\"12\" r=\"4.5\" ${stroke}/><path d=\"M12 2v3M12 19v3M2 12h3M19 12h3\" ${stroke}/>`, size, cls);\n    case 'box':\n      return svgWrap(`<path d=\"M12 3l9 5-9 5-9-5 9-5z\" ${stroke}/><path d=\"M3 8v8l9 5 9-5V8\" ${stroke}/><path d=\"M12 13v8\" ${stroke}/>`, size, cls);\n    case 'info':\n      return svgWrap(`<circle cx=\"12\" cy=\"12\" r=\"8.5\" ${stroke}/><path d=\"M12 10v6\" ${stroke}/><path d=\"M12 7h.01\" ${stroke}/>`, size, cls);\n    default:\n      return svgWrap(`<circle cx=\"12\" cy=\"12\" r=\"9\" ${stroke}/>`, size, cls);\n  }\n}\n", "import { renderIcon } from './Icon';\n\nlet _box: HTMLElement | null = null;\n\nfunction ensureBox(): HTMLElement {\n  if (_box) return _box;\n  const div = document.createElement('div');\n  div.className = 'toast-wrap';\n  document.body.appendChild(div);\n  _box = div;\n  return div;\n}\n\ntype ToastType = 'info' | 'success' | 'warn' | 'error';\ntype ToastOptions = { type?: ToastType; duration?: number };\n\nexport function showToast(text: string, opts?: ToastType | ToastOptions) {\n  const box = ensureBox();\n  const item = document.createElement('div');\n  let type: ToastType | undefined;\n  let duration = 3500;\n  if (typeof opts === 'string') type = opts;\n  else if (opts) { type = opts.type; if (opts.duration) duration = opts.duration; }\n  item.className = 'toast' + (type ? ' ' + type : '');\n  // icon + text container\n  try {\n    const wrap = document.createElement('div');\n    wrap.style.display = 'flex';\n    wrap.style.gap = '8px';\n    wrap.style.alignItems = 'center';\n    const icoName = type === 'success' ? 'bolt' : type === 'warn' ? 'clock' : type === 'error' ? 'close' : 'info';\n    const icoHost = document.createElement('span');\n    icoHost.appendChild(renderIcon(icoName, { size: 18 }));\n    const txt = document.createElement('div');\n    txt.textContent = text;\n    wrap.appendChild(icoHost);\n    wrap.appendChild(txt);\n    item.appendChild(wrap);\n  } catch {\n    item.textContent = text;\n  }\n  const life = document.createElement('i');\n  life.className = 'life';\n  life.style.setProperty('--life', duration + 'ms');\n  item.appendChild(life);\n  box.prepend(item);\n  // graceful exit\n  const fade = () => { item.style.opacity = '0'; item.style.transition = 'opacity .45s'; setTimeout(() => item.remove(), 460); };\n  const timer = window.setTimeout(fade, duration);\n  item.addEventListener('click', () => { clearTimeout(timer); fade(); });\n}\n", "import { GameManager } from '../core/GameManager';\nimport { html, qs } from '../utils/dom';\nimport { showToast } from '../components/Toast';\nimport { renderIcon } from '../components/Icon';\n\nexport class LoginScene {\n  mount(root: HTMLElement) {\n    const view = html(`\n      <div class=\"container grid-2\" style=\"color:#fff;\">\n        <div class=\"card fade-in\" style=\"max-width:460px;margin:46px auto;\">\n          <div class=\"scene-header\">\n            <div>\n              <h1 style=\"background:var(--grad);-webkit-background-clip:text;background-clip:text;color:transparent;display:flex;align-items:center;gap:8px;\"><span data-ico=\"home\"></span>\u77FF\u573A\u6307\u6325\u4E2D\u5FC3</h1>\n              <p>\u767B\u5F55\u540E\u8FDB\u5165\u4F60\u7684\u8D5B\u535A\u77FF\u57CE\u3002</p>\n            </div>\n          </div>\n          <input id=\"u\" class=\"input\" placeholder=\"\u7528\u6237\u540D\" autocomplete=\"username\"/>\n          <div class=\"row\" style=\"align-items:center;\">\n            <input id=\"p\" class=\"input\" placeholder=\"\u5BC6\u7801\" type=\"password\" autocomplete=\"current-password\"/>\n            <button id=\"reveal\" class=\"btn btn-ghost\" style=\"min-width:110px;\"><span data-ico=\"eye\"></span>\u663E\u793A</button>\n          </div>\n          <button id=\"go\" class=\"btn btn-primary\" style=\"width:100%;margin-top:8px;\"><span data-ico=\"arrow-right\"></span>\u8FDB\u5165\u6E38\u620F</button>\n          <div style=\"margin-top:8px;opacity:.75;font-size:12px;\">\u63D0\u793A\uFF1A\u82E5\u8D26\u6237\u4E0D\u5B58\u5728\uFF0C\u5C06\u81EA\u52A8\u521B\u5EFA\u5E76\u767B\u5F55\u3002</div>\n        </div>\n      </div>\n    `);\n    root.innerHTML = '';\n    root.appendChild(view);\n\n    const uEl = qs<HTMLInputElement>(view, '#u');\n    const pEl = qs<HTMLInputElement>(view, '#p');\n    const go = qs<HTMLButtonElement>(view, '#go');\n    const reveal = qs<HTMLButtonElement>(view, '#reveal');\n\n    const submit = async () => {\n      const username = (uEl.value || '').trim();\n      const password = (pEl.value || '').trim();\n      if (!username || !password) {\n        showToast('\u8BF7\u586B\u5199\u7528\u6237\u540D\u548C\u5BC6\u7801', 'warn');\n        return;\n      }\n      go.disabled = true;\n      go.textContent = '\u767B\u5F55\u4E2D\u2026';\n      try {\n        await GameManager.I.loginOrRegister(username, password);\n        location.hash = '#/main';\n      } catch (e: any) {\n        showToast(e?.message || '\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5', 'error');\n      } finally {\n        go.disabled = false;\n        go.textContent = '\u8FDB\u5165\u6E38\u620F';\n      }\n    };\n\n    go.onclick = submit;\n    uEl.onkeyup = (e) => { if ((e as KeyboardEvent).key === 'Enter') submit(); };\n    pEl.onkeyup = (e) => { if ((e as KeyboardEvent).key === 'Enter') submit(); };\n    reveal.onclick = () => {\n      const isPwd = pEl.type === 'password';\n      pEl.type = isPwd ? 'text' : 'password';\n      reveal.innerHTML = '';\n      reveal.appendChild(renderIcon(isPwd ? 'eye-off' : 'eye', { size: 20 }));\n      reveal.appendChild(document.createTextNode(isPwd ? '\u9690\u85CF' : '\u663E\u793A'));\n    };\n  }\n}\n    // mount icons\n    try {\n      view.querySelectorAll('[data-ico]')\n        .forEach((el) => {\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\n          try { el.appendChild(renderIcon(name, { size: 22 })); } catch {}\n        });\n    } catch {}\n", "export const API_BASE = (window as any).__API_BASE__ || 'http://localhost:3000/api';\r\nexport const WS_ENDPOINT = (window as any).__WS_ENDPOINT__ || 'http://localhost:3000/game';\r\n\r\n\r\n", "import { WS_ENDPOINT } from './Env';\n\ntype Handler = (data: any) => void;\n\nexport class RealtimeClient {\n  private static _instance: RealtimeClient;\n  static get I(): RealtimeClient {\n    return this._instance ?? (this._instance = new RealtimeClient());\n  }\n\n  private socket: any | null = null;\n  private handlers: Record<string, Handler[]> = {};\n\n  connect(token: string) {\n    const w = window as any;\n    if (w.io) {\n      if (this.socket && (this.socket.connected || this.socket.connecting)) return;\n      this.socket = w.io(WS_ENDPOINT, { auth: { token } });\n      this.socket.on('connect', () => {});\n      this.socket.onAny((event: string, payload: any) => this.emitLocal(event, payload));\n    } else {\n      // socket.io client not loaded; disable realtime updates\n      this.socket = null;\n    }\n  }\n\n  on(event: string, handler: Handler) {\n    (this.handlers[event] ||= []).push(handler);\n  }\n\n  off(event: string, handler: Handler) {\n    const arr = this.handlers[event];\n    if (!arr) return;\n    const idx = arr.indexOf(handler);\n    if (idx >= 0) arr.splice(idx, 1);\n  }\n\n  private emitLocal(event: string, payload: any) {\n    (this.handlers[event] || []).forEach((h) => h(payload));\n  }\n}\n", "import { renderIcon } from './Icon';\n\nexport function renderNav(active: string): HTMLElement {\n  const tabs: { key: string; text: string; href: string; icon: any }[] = [\n    { key: 'main', text: '\u4E3B\u9875', href: '#/main', icon: 'home' },\n    { key: 'warehouse', text: '\u4ED3\u5E93', href: '#/warehouse', icon: 'warehouse' },\n    { key: 'plunder', text: '\u63A0\u593A', href: '#/plunder', icon: 'plunder' },\n    { key: 'exchange', text: '\u4EA4\u6613\u6240', href: '#/exchange', icon: 'exchange' },\n    { key: 'ranking', text: '\u6392\u884C', href: '#/ranking', icon: 'ranking' },\n  ];\n  const wrap = document.createElement('div');\n  wrap.className = 'nav';\n  for (const t of tabs) {\n    const a = document.createElement('a');\n    a.href = t.href;\n    const ico = renderIcon(t.icon, { size: 18, className: 'ico' });\n    const label = document.createElement('span');\n    label.textContent = t.text;\n    a.appendChild(ico);\n    a.appendChild(label);\n    if (t.key === active) a.classList.add('active');\n    wrap.appendChild(a);\n  }\n  return wrap;\n}\n", "import { NetworkManager } from '../core/NetworkManager';\nimport { renderIcon } from './Icon';\n\nexport function renderResourceBar() {\n  const box = document.createElement('div');\n  box.className = 'container';\n  const card = document.createElement('div');\n  card.className = 'card fade-in';\n  card.innerHTML = `\n    <div style=\"display:flex;justify-content:space-between\"><span>\uD83D\uDC8E \u77FF\u77F3</span><strong id=\"ore\">0</strong></div>\n    <div style=\"display:flex;justify-content:space-between\"><span>\uD83E\uDE99 BB\u5E01</span><strong id=\"coin\">0</strong></div>\n  `;\n  // override with enhanced stats layout\n  card.innerHTML = `\n    <div class=\"stats\">\n      <div class=\"stat\">\n        <div class=\"ico\" data-ico=\"ore\"></div>\n        <div style=\"display:flex;flex-direction:column;gap:2px;\">\n          <div class=\"val\" id=\"ore\">0</div>\n          <div class=\"label\">\u77FF\u77F3</div>\n        </div>\n      </div>\n      <div class=\"stat\">\n        <div class=\"ico\" data-ico=\"coin\"></div>\n        <div style=\"display:flex;flex-direction:column;gap:2px;\">\n          <div class=\"val\" id=\"coin\">0</div>\n          <div class=\"label\">BB</div>\n        </div>\n      </div>\n    </div>\n  `;\n  box.appendChild(card);\n  // inject icons\n  try {\n    const oreIco = card.querySelector('[data-ico=\"ore\"]');\n    const coinIco = card.querySelector('[data-ico=\"coin\"]');\n    if (oreIco) oreIco.appendChild(renderIcon('ore', { size: 18 }));\n    if (coinIco) coinIco.appendChild(renderIcon('coin', { size: 18 }));\n  } catch {}\n  const oreEl = card.querySelector('#ore') as HTMLElement;\n  const coinEl = card.querySelector('#coin') as HTMLElement;\n  async function update() {\n    try {\n      const p = await NetworkManager.I.request<{ id: string; username: string; nickname: string; oreAmount: number; bbCoins: number }>('/user/profile');\n      oreEl.textContent = String(p.oreAmount);\n      coinEl.textContent = String(p.bbCoins);\n    } catch {\n      // ignore fetch errors; UI \u4F1A\u5728\u4E0B\u4E00\u6B21\u5237\u65B0\u65F6\u6062\u590D\n    }\n  }\n  return { root: box, update };\n}\n", "export function spawnFloatText(anchor: Element, text: string, color = '#fff') {\n  const rect = anchor.getBoundingClientRect();\n  const span = document.createElement('div');\n  span.textContent = text;\n  span.style.cssText = `position:fixed;left:${rect.left + rect.width - 24}px;top:${rect.top - 6}px;`+\n    'transform: translateY(0); transition: all .7s cubic-bezier(.22,.61,.36,1);'+\n    'pointer-events:none; z-index:9999; font-weight:700; color:'+color+'; text-shadow:0 0 8px rgba(255,255,255,.25)';\n  document.body.appendChild(span);\n  requestAnimationFrame(() => {\n    span.style.opacity = '0';\n    span.style.transform = 'translateY(-24px)';\n  });\n  setTimeout(() => span.remove(), 800);\n}\n\n", "import { NetworkManager } from '../core/NetworkManager';\r\nimport { RealtimeClient } from '../core/RealtimeClient';\r\nimport { html, qs } from '../utils/dom';\r\nimport { renderNav } from '../components/Nav';\r\nimport { renderResourceBar } from '../components/ResourceBar';\r\nimport { showToast } from '../components/Toast';\r\nimport { spawnFloatText } from '../components/FloatText';\r\nimport { renderIcon } from '../components/Icon';\r\n\r\ntype MineStatus = {\r\n  cartAmount: number;\r\n  cartCapacity: number;\r\n  collapsed: boolean;\r\n  collapsedRemaining: number;\r\n  running: boolean;\r\n  intervalMs: number;\r\n};\r\n\r\ntype PendingAction = 'start' | 'stop' | 'collect' | 'repair' | 'status' | null;\r\n\r\nexport class MainScene {\r\n  private view: HTMLElement | null = null;\r\n  private cartAmt = 0;\r\n  private cartCap = 1000;\r\n  private isMining = false;\r\n  private isCollapsed = false;\r\n  private collapseRemaining = 0;\r\n  private collapseTimer: number | null = null;\r\n  private intervalMs = 3000;\r\n  private pending: PendingAction = null;\r\n\r\n  private els = {\r\n    fill: null as HTMLElement | null,\r\n    percent: null as HTMLElement | null,\r\n    statusText: null as HTMLElement | null,\r\n    ring: null as HTMLElement | null,\r\n    ringPct: null as HTMLElement | null,\r\n    cycle: null as HTMLElement | null,\r\n    statusTag: null as HTMLElement | null,\r\n    events: null as HTMLElement | null,\r\n    start: null as HTMLButtonElement | null,\r\n    stop: null as HTMLButtonElement | null,\r\n    collect: null as HTMLButtonElement | null,\r\n    repair: null as HTMLButtonElement | null,\r\n    statusBtn: null as HTMLButtonElement | null,\r\n  };\r\n\r\n  private mineUpdateHandler?: (msg: any) => void;\r\n  private mineCollapseHandler?: (msg: any) => void;\r\n  private plunderHandler?: (msg: any) => void;\r\n\r\n  async mount(root: HTMLElement) {\r\n    this.clearCollapseTimer();\r\n    this.pending = null;\r\n\r\n    const nav = renderNav('main');\n    const bar = renderResourceBar();\n    const view = html(`\n      <section class=\"main-screen\">\n        <div class=\"main-ambient\" aria-hidden=\"true\">\n          <span class=\"ambient orb orb-a\"></span>\n          <span class=\"ambient orb orb-b\"></span>\n          <span class=\"ambient grid\"></span>\n        </div>\n        <div class=\"container main-stack\" style=\"color:#fff;\">\n          <section class=\"mine card mine-card fade-in\">\n            <header class=\"mine-header\">\n              <div class=\"mine-title\">\n                <span class=\"title-icon\" data-ico=\"pick\"></span>\n                <span class=\"title-label\">\u6316\u77FF\u9762\u677F</span>\n              </div>\n              <div class=\"mine-chips\">\n                <span class=\"pill\" id=\"statusTag\">\u5F85\u673A</span>\n                <span class=\"pill pill-cycle\"><span data-ico=\"clock\"></span>\u5468\u671F <span id=\"cycle\">3s</span></span>\n              </div>\n            </header>\n            <div class=\"mine-grid\">\n              <div class=\"mine-gauge\">\n                <div class=\"ring\" id=\"ring\">\n                  <div class=\"ring-core\">\n                    <span id=\"ringPct\">0%</span>\n                    <small>\u88C5\u8F7D\u7387</small>\n                  </div>\n                </div>\n                <div class=\"ring-glow ring-glow-a\"></div>\n                <div class=\"ring-glow ring-glow-b\"></div>\n              </div>\n              <div class=\"mine-progress\">\n                <div class=\"mine-progress-meta\">\n                  <span>\u77FF\u8F66\u88C5\u8F7D</span>\n                  <strong id=\"percent\">0%</strong>\n                </div>\n                <div class=\"mine-progress-track\">\n                  <div class=\"mine-progress-fill\" id=\"fill\"></div>\n                </div>\n                <div id=\"statusText\" class=\"mine-status\"></div>\n              </div>\n            </div>\n            <div class=\"mine-actions-grid\">\n              <button id=\"start\" class=\"btn btn-buy span-2\"><span data-ico=\"play\"></span>\u5F00\u59CB\u6316\u77FF</button>\n              <button id=\"stop\" class=\"btn btn-ghost\"><span data-ico=\"stop\"></span>\u505C\u6B62</button>\n              <button id=\"collect\" class=\"btn btn-primary\"><span data-ico=\"collect\"></span>\u6536\u77FF</button>\n              <button id=\"status\" class=\"btn btn-ghost\"><span data-ico=\"refresh\"></span>\u5237\u65B0\u72B6\u6001</button>\n              <button id=\"repair\" class=\"btn btn-sell\"><span data-ico=\"wrench\"></span>\u4FEE\u7406</button>\n            </div>\n            <div class=\"mine-feed\">\n              <div class=\"event-feed\" id=\"events\"></div>\n            </div>\n            <div class=\"mine-hologram\" aria-hidden=\"true\">\n              <span class=\"mine-holo-grid\"></span>\n              <span class=\"mine-holo-grid diagonal\"></span>\n              <span class=\"mine-holo-glow\"></span>\n              <span class=\"mine-shard shard-1\"></span>\n              <span class=\"mine-shard shard-2\"></span>\n              <span class=\"mine-shard shard-3\"></span>\n            </div>\n          </section>\n        </div>\n      </section>\n    `);\r\n\r\n    root.innerHTML = '';\r\n    root.appendChild(nav);\r\n    root.appendChild(bar.root);\r\n    root.appendChild(view);\r\n\r\n    this.view = view;\r\n    // mount icons in header/buttons\r\n    try {\r\n      view.querySelectorAll('[data-ico]')\r\n        .forEach((el) => {\r\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\r\n          try { el.appendChild(renderIcon(name, { size: 20 })); } catch {}\r\n        });\r\n    } catch {}\r\n    this.cacheElements();\r\n    this.attachHandlers(bar.update.bind(bar));\r\n    await bar.update();\r\n    this.setupRealtime();\r\n    await this.refreshStatus();\r\n    this.updateProgress();\r\n    this.updateControls();\r\n  }\r\n\r\n  private cacheElements() {\r\n    if (!this.view) return;\r\n    this.els.fill = qs(this.view, '#fill');\r\n    this.els.percent = qs(this.view, '#percent');\r\n    this.els.statusText = qs(this.view, '#statusText');\r\n    this.els.ring = this.view.querySelector('#ring');\r\n    this.els.ringPct = this.view.querySelector('#ringPct');\r\n    this.els.cycle = this.view.querySelector('#cycle');\r\n    this.els.statusTag = this.view.querySelector('#statusTag');\r\n    this.els.events = this.view.querySelector('#events');\r\n    this.els.start = qs<HTMLButtonElement>(this.view, '#start');\r\n    this.els.stop = qs<HTMLButtonElement>(this.view, '#stop');\r\n    this.els.collect = qs<HTMLButtonElement>(this.view, '#collect');\r\n    this.els.repair = qs<HTMLButtonElement>(this.view, '#repair');\r\n    this.els.statusBtn = qs<HTMLButtonElement>(this.view, '#status');\r\n  }\n\n  private attachHandlers(updateBar: () => Promise<void>) {\r\n    if (!this.view) return;\r\n    this.els.start?.addEventListener('click', () => this.handleStart());\r\n    this.els.stop?.addEventListener('click', () => this.handleStop());\r\n    this.els.statusBtn?.addEventListener('click', () => this.refreshStatus());\r\n    this.els.repair?.addEventListener('click', () => this.handleRepair());\r\n    this.els.collect?.addEventListener('click', () => this.handleCollect(updateBar));\r\n  }\r\n\r\n  private setupRealtime() {\r\n    const token = (NetworkManager as any).I['token'];\r\n    if (token) RealtimeClient.I.connect(token);\r\n\r\n    if (this.mineUpdateHandler) RealtimeClient.I.off('mine.update', this.mineUpdateHandler);\r\n    if (this.mineCollapseHandler) RealtimeClient.I.off('mine.collapse', this.mineCollapseHandler);\r\n    if (this.plunderHandler) RealtimeClient.I.off('plunder.attacked', this.plunderHandler);\r\n\r\n    this.mineUpdateHandler = (msg) => {\r\n      this.cartAmt = typeof msg.cartAmount === 'number' ? msg.cartAmount : this.cartAmt;\r\n      this.cartCap = typeof msg.cartCapacity === 'number' ? msg.cartCapacity : this.cartCap;\r\n      this.isMining = msg.running ?? this.isMining;\r\n      if (msg.collapsed && msg.collapsedRemaining) {\r\n        this.beginCollapseCountdown(msg.collapsedRemaining);\r\n      } else if (!msg.collapsed) {\r\n        this.isCollapsed = false;\r\n        this.clearCollapseTimer();\r\n      }\r\n      this.updateProgress();\r\n      if (msg.type === 'critical' && msg.amount) {\r\n        this.setStatusMessage(`\u89E6\u53D1\u66B4\u51FB\uFF0C\u77FF\u8F66\u589E\u52A0 ${msg.amount}\uFF01`);\r\n        this.logEvent(`\u66B4\u51FB +${msg.amount}`);\r\n      } else if (msg.type === 'normal' && msg.amount) {\r\n        this.setStatusMessage(`\u77FF\u8F66\u589E\u52A0 ${msg.amount}\uFF0C\u5F53\u524D ${this.formatPercent()}`);\r\n        this.logEvent(`\u6316\u6398 +${msg.amount}`);\r\n      } else if (msg.type === 'collapse') {\r\n        this.setStatusMessage('\u77FF\u9053\u574D\u584C\uFF0C\u8BF7\u7ACB\u5373\u4FEE\u7406');\r\n        this.logEvent('\u77FF\u9053\u574D\u584C');\r\n      } else if (msg.type === 'collect') {\r\n        this.setStatusMessage('\u77FF\u77F3\u5DF2\u6536\u96C6\uFF0C\u77FF\u8F66\u6E05\u7A7A');\r\n        this.logEvent('\u6536\u96C6\u5B8C\u6210');\r\n      } else if (this.isCollapsed) {\r\n        this.setStatusMessage(`\u77FF\u9053\u574D\u584C\uFF0C\u5269\u4F59 ${this.collapseRemaining}s`);\r\n      }\r\n      this.updateControls();\r\n    };\r\n\r\n    this.mineCollapseHandler = (msg) => {\r\n      const seconds = Number(msg?.repair_duration) || 0;\r\n      if (seconds > 0) this.beginCollapseCountdown(seconds);\r\n      showToast(`\u77FF\u9053\u574D\u584C\uFF0C\u9700\u4FEE\u7406\uFF08\u7EA6 ${seconds}s\uFF09`, 'warn');\r\n    };\r\n\r\n    this.plunderHandler = (msg) => {\r\n      showToast(`\u88AB\u63A0\u593A\uFF1A\u6765\u81EA ${msg.attacker}\uFF0C\u635F\u5931 ${msg.loss}`, 'warn');\r\n      this.logEvent(`\u88AB ${msg.attacker} \u63A0\u593A -${msg.loss}`);\r\n    };\r\n\r\n    RealtimeClient.I.on('mine.update', this.mineUpdateHandler);\r\n    RealtimeClient.I.on('mine.collapse', this.mineCollapseHandler);\r\n    RealtimeClient.I.on('plunder.attacked', this.plunderHandler);\r\n  }\r\n\r\n  private async handleStart() {\r\n    if (this.pending || this.isCollapsed) {\r\n      if (this.isCollapsed) showToast('\u77FF\u9053\u574D\u584C\uFF0C\u8BF7\u5148\u4FEE\u7406', 'warn');\r\n      return;\r\n    }\r\n    this.pending = 'start';\r\n    this.updateControls();\r\n    try {\r\n      const status = await NetworkManager.I.request<MineStatus>('/mine/start', { method: 'POST' });\r\n      this.applyStatus(status);\r\n      this.setStatusMessage('\u77FF\u673A\u5DF2\u542F\u52A8');\r\n      showToast('\u77FF\u673A\u5DF2\u542F\u52A8', 'success');\r\n    } catch (e: any) {\r\n      showToast(e?.message || '\u542F\u52A8\u5931\u8D25', 'error');\r\n    } finally {\r\n      this.pending = null;\r\n      this.updateControls();\r\n    }\r\n  }\r\n\r\n  private async handleStop() {\r\n    if (this.pending) return;\r\n    this.pending = 'stop';\r\n    this.updateControls();\r\n    try {\r\n      const status = await NetworkManager.I.request<MineStatus>('/mine/stop', { method: 'POST' });\r\n      this.applyStatus(status);\r\n      this.setStatusMessage('\u77FF\u673A\u5DF2\u505C\u6B62');\r\n      showToast('\u77FF\u673A\u5DF2\u505C\u6B62', 'success');\r\n    } catch (e: any) {\r\n      showToast(e?.message || '\u505C\u6B62\u5931\u8D25', 'error');\r\n    } finally {\r\n      this.pending = null;\r\n      this.updateControls();\r\n    }\r\n  }\r\n\r\n  private async handleCollect(updateBar: () => Promise<void>) {\r\n    if (this.pending || this.cartAmt <= 0) return;\r\n    this.pending = 'collect';\r\n    this.updateControls();\r\n    try {\r\n      const res = await NetworkManager.I.request<{ collected: number; status: MineStatus }>('/mine/collect', { method: 'POST' });\r\n      if (res.status) this.applyStatus(res.status);\r\n      if (res.collected > 0) {\r\n        const oreLabel = document.querySelector('#ore');\r\n        if (oreLabel) spawnFloatText(oreLabel as Element, `+${res.collected}`, '#7B2CF5');\r\n        showToast(`\u6536\u96C6\u77FF\u77F3 ${res.collected}`, 'success');\r\n      } else {\r\n        showToast('\u77FF\u8F66\u4E3A\u7A7A\uFF0C\u65E0\u77FF\u77F3\u53EF\u6536\u96C6', 'warn');\r\n      }\r\n      await updateBar();\r\n    } catch (e: any) {\r\n      showToast(e?.message || '\u6536\u77FF\u5931\u8D25', 'error');\r\n    } finally {\r\n      this.pending = null;\r\n      this.updateControls();\r\n    }\r\n  }\r\n\r\n  private async handleRepair() {\r\n    if (this.pending || !this.isCollapsed) return;\r\n    this.pending = 'repair';\r\n    this.updateControls();\r\n    try {\r\n      const status = await NetworkManager.I.request<MineStatus>('/mine/repair', { method: 'POST' });\r\n      this.applyStatus(status);\r\n      this.setStatusMessage('\u77FF\u9053\u5DF2\u4FEE\u590D\uFF0C\u53EF\u91CD\u65B0\u542F\u52A8');\r\n      showToast('\u77FF\u9053\u5DF2\u4FEE\u590D', 'success');\r\n    } catch (e: any) {\r\n      showToast(e?.message || '\u4FEE\u7406\u5931\u8D25', 'error');\r\n    } finally {\r\n      this.pending = null;\r\n      this.updateControls();\r\n    }\r\n  }\r\n\r\n  private async refreshStatus() {\r\n    if (this.pending === 'status') return;\r\n    this.pending = 'status';\r\n    this.updateControls();\r\n    try {\r\n      const status = await NetworkManager.I.request<MineStatus>('/mine/status');\r\n      this.applyStatus(status);\r\n    } catch (e: any) {\r\n      showToast(e?.message || '\u83B7\u53D6\u72B6\u6001\u5931\u8D25', 'error');\r\n    } finally {\r\n      this.pending = null;\r\n      this.updateControls();\r\n    }\r\n  }\r\n\r\n  private applyStatus(status: MineStatus | undefined, opts: { quiet?: boolean } = {}) {\r\n    if (!status) return;\r\n    this.cartAmt = status.cartAmount ?? this.cartAmt;\r\n    this.cartCap = status.cartCapacity ?? this.cartCap;\r\n    this.intervalMs = status.intervalMs ?? this.intervalMs;\r\n    this.isMining = Boolean(status.running);\r\n    this.isCollapsed = Boolean(status.collapsed);\r\n    if (status.collapsed && status.collapsedRemaining > 0) {\r\n      this.beginCollapseCountdown(status.collapsedRemaining);\r\n    } else {\r\n      this.clearCollapseTimer();\r\n      this.collapseRemaining = 0;\r\n    }\r\n    this.updateProgress();\r\n    if (!opts.quiet) {\r\n      if (this.isCollapsed && this.collapseRemaining > 0) {\r\n        this.setStatusMessage(`\u77FF\u9053\u574D\u584C\uFF0C\u5269\u4F59 ${this.collapseRemaining}s`);\r\n      } else if (this.isMining) {\r\n        const seconds = Math.max(1, Math.round(this.intervalMs / 1000));\r\n        this.setStatusMessage(`\u77FF\u673A\u8FD0\u884C\u4E2D\uFF0C\u5468\u671F\u7EA6 ${seconds}s\uFF0C\u5F53\u524D ${this.formatPercent()}`);\r\n      } else {\r\n        this.setStatusMessage('\u77FF\u673A\u5DF2\u505C\u6B62\uFF0C\u70B9\u51FB\u5F00\u59CB\u6316\u77FF');\r\n      }\r\n    }\r\n    if (this.els.cycle) {\r\n      const seconds = Math.max(1, Math.round(this.intervalMs / 1000));\r\n      this.els.cycle.textContent = `${seconds}s`;\r\n    }\r\n    if (this.els.statusTag) {\r\n      const el = this.els.statusTag as HTMLElement;\r\n      el.innerHTML = '';\r\n      const ico = this.isCollapsed ? 'close' : (this.isMining ? 'bolt' : 'clock');\r\n      try { el.appendChild(renderIcon(ico as any, { size: 16 })); } catch {}\r\n      el.appendChild(document.createTextNode(this.isCollapsed ? '\u574D\u584C' : (this.isMining ? '\u8FD0\u884C\u4E2D' : '\u5F85\u673A')));\r\n    }\r\n    this.updateControls();\r\n  }\r\n\r\n  private beginCollapseCountdown(seconds: number) {\r\n    this.clearCollapseTimer();\r\n    this.isCollapsed = true;\r\n    this.collapseRemaining = Math.max(0, Math.floor(seconds));\r\n    this.setStatusMessage(`\u77FF\u9053\u574D\u584C\uFF0C\u5269\u4F59 ${this.collapseRemaining}s`);\r\n    this.updateControls();\r\n    this.collapseTimer = window.setInterval(() => {\r\n      this.collapseRemaining = Math.max(0, this.collapseRemaining - 1);\r\n      if (this.collapseRemaining <= 0) {\r\n        this.clearCollapseTimer();\r\n        this.isCollapsed = false;\r\n        this.setStatusMessage('\u574D\u584C\u89E3\u9664\uFF0C\u53EF\u91CD\u65B0\u542F\u52A8\u77FF\u673A');\r\n        this.updateControls();\r\n      } else {\r\n        this.setStatusMessage(`\u77FF\u9053\u574D\u584C\uFF0C\u5269\u4F59 ${this.collapseRemaining}s`);\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  private clearCollapseTimer() {\r\n    if (this.collapseTimer !== null) {\r\n      window.clearInterval(this.collapseTimer);\r\n      this.collapseTimer = null;\r\n    }\r\n  }\r\n\r\n  private updateProgress() {\r\n    if (!this.els.fill || !this.els.percent) return;\r\n    const pct = this.cartCap > 0 ? Math.min(1, this.cartAmt / this.cartCap) : 0;\r\n    this.els.fill.style.width = `${Math.round(pct * 100)}%`;\r\n    this.els.percent.textContent = `${Math.round(pct * 100)}%`;\r\n    if (this.els.ring) {\r\n      const deg = Math.round(pct * 360);\r\n      (this.els.ring as HTMLElement).style.background = `conic-gradient(#7B2CF5 ${deg}deg, rgba(255,255,255,.08) 0deg)`;\r\n    }\r\n    if (this.els.ringPct) this.els.ringPct.textContent = `${Math.round(pct * 100)}%`;\r\n    if (this.pending !== 'collect' && this.els.collect) {\r\n      this.els.collect.disabled = this.pending === 'collect' || this.cartAmt <= 0;\r\n    }\r\n  }\r\n\r\n  private updateControls() {\r\n    const isBusy = (key: PendingAction) => this.pending === key;\r\n    const setBtn = (btn: HTMLButtonElement | null, icon: any, label: string, disabled: boolean) => {\r\n      if (!btn) return;\r\n      btn.disabled = disabled;\r\n      // keep first child as icon if present, otherwise create\r\n      let iconHost = btn.querySelector('.icon');\r\n      if (!iconHost) {\r\n        btn.insertBefore(renderIcon(icon, { size: 18 }), btn.firstChild);\r\n      } else {\r\n        // Replace existing icon with new one if icon name differs by re-rendering\r\n        const host = document.createElement('span');\r\n        host.appendChild(renderIcon(icon, { size: 18 }));\r\n        // remove old icon wrapper and use new\r\n        iconHost.parentElement?.replaceChild(host.firstChild as Node, iconHost);\r\n      }\r\n      // set label text (preserve icon)\r\n      // remove existing text nodes\r\n      Array.from(btn.childNodes).forEach((n, idx) => {\r\n        if (idx > 0) btn.removeChild(n);\r\n      });\r\n      btn.appendChild(document.createTextNode(label));\r\n    };\r\n\r\n    setBtn(this.els.start, 'play', isBusy('start') ? '\u542F\u52A8\u4E2D\u2026' : this.isMining ? '\u6316\u77FF\u4E2D' : '\u5F00\u59CB\u6316\u77FF', isBusy('start') || this.isMining || this.isCollapsed);\r\n    setBtn(this.els.stop, 'stop', isBusy('stop') ? '\u505C\u6B62\u4E2D\u2026' : '\u505C\u6B62', isBusy('stop') || !this.isMining);\r\n    setBtn(this.els.collect, 'collect', isBusy('collect') ? '\u6536\u96C6\u4E2D\u2026' : '\u6536\u77FF', isBusy('collect') || this.cartAmt <= 0);\r\n    setBtn(this.els.repair, 'wrench', isBusy('repair') ? '\u4FEE\u7406\u4E2D\u2026' : '\u4FEE\u7406', isBusy('repair') || !this.isCollapsed);\r\n    setBtn(this.els.statusBtn, 'refresh', isBusy('status') ? '\u5237\u65B0\u4E2D\u2026' : '\u5237\u65B0\u72B6\u6001', isBusy('status'));\r\n  }\r\n\r\n  private setStatusMessage(text: string) {\r\n    if (!this.els.statusText) return;\r\n    this.els.statusText.textContent = text;\r\n  }\r\n\r\n  private logEvent(msg: string) {\r\n    if (!this.els?.events) return;\r\n    const line = document.createElement('div');\r\n    line.className = 'event';\r\n    const now = new Date();\r\n    const hh = String(now.getHours()).padStart(2,'0');\r\n    const mm = String(now.getMinutes()).padStart(2,'0');\r\n    const ss = String(now.getSeconds()).padStart(2,'0');\r\n    line.textContent = `[${hh}:${mm}:${ss}] ${msg}`;\r\n    this.els.events.prepend(line);\r\n  }\r\n\r\n  private formatPercent() {\r\n    const pct = this.cartCap > 0 ? Math.min(1, this.cartAmt / this.cartCap) : 0;\r\n    return `${Math.round(pct * 100)}%`;\r\n  }\r\n}", "import { NetworkManager } from '../core/NetworkManager';\nimport { html, qs } from '../utils/dom';\nimport { renderNav } from '../components/Nav';\nimport { RealtimeClient } from '../core/RealtimeClient';\nimport { renderResourceBar } from '../components/ResourceBar';\nimport { showToast } from '../components/Toast';\nimport { renderIcon } from '../components/Icon';\n\nexport class WarehouseScene {\n  async mount(root: HTMLElement) {\n    root.innerHTML = '';\n    root.appendChild(renderNav('warehouse'));\n    const bar = renderResourceBar();\n    root.appendChild(bar.root);\n\n    const view = html(`\n      <div class=\"container grid-2\" style=\"color:#fff;\">\n        <div class=\"card fade-in\">\n          <div class=\"row\" style=\"justify-content:space-between;align-items:center;\">\n            <h3 style=\"margin:0;display:flex;align-items:center;gap:8px;\"><span data-ico=\"warehouse\"></span>\u4ED3\u5E93</h3>\n            <button id=\"refresh\" class=\"btn btn-primary\"><span data-ico=\"refresh\"></span>\u5237\u65B0</button>\n          </div>\n          <div style=\"margin-top:12px;\">\n            <details open>\n              <summary><span data-ico=\"box\"></span>\u6211\u7684\u9053\u5177</summary>\n              <div id=\"list\" style=\"margin-top:8px;display:flex;flex-direction:column;gap:8px;\"></div>\n            </details>\n            <details>\n              <summary><span data-ico=\"list\"></span>\u9053\u5177\u6A21\u677F</summary>\n              <div id=\"tpls\" style=\"margin-top:8px;display:flex;flex-direction:column;gap:8px;\"></div>\n            </details>\n          </div>\n        </div>\n      </div>\n    `);\n    root.appendChild(view);\n\n    const token = (NetworkManager as any).I['token'];\n    if (token) RealtimeClient.I.connect(token);\n\n    const list = qs(view, '#list');\n    const tplContainer = qs(view, '#tpls');\n    const refreshBtn = qs<HTMLButtonElement>(view, '#refresh');\n\n    const mountIcons = (rootEl: Element) => {\n      rootEl.querySelectorAll('[data-ico]')\n        .forEach((el) => {\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\n          try { el.appendChild(renderIcon(name, { size: 20 })); } catch {}\n        });\n    };\n    mountIcons(view);\n\n    const getRarity = (item: any, tpl?: any): { key: 'common'|'rare'|'epic'|'legendary'; text: string } => {\n      const r = (tpl && (tpl.rarity || tpl.tier)) || item.rarity;\n      const level = Number(item.level) || 0;\n      if (typeof r === 'string') {\n        const k = r.toLowerCase();\n        if (['legendary','epic','rare','common'].includes(k)) {\n          return { key: k as any, text: k === 'legendary' ? '\u4F20\u8BF4' : k === 'epic' ? '\u53F2\u8BD7' : k === 'rare' ? '\u7A00\u6709' : '\u666E\u901A' };\n        }\n      }\n      if (level >= 12) return { key: 'legendary', text: '\u4F20\u8BF4' };\n      if (level >= 8) return { key: 'epic', text: '\u53F2\u8BD7' };\n      if (level >= 4) return { key: 'rare', text: '\u7A00\u6709' };\n      return { key: 'common', text: '\u666E\u901A' };\n    };\n\n    const formatTime = (ts: number) => {\n      try { return new Date(ts).toLocaleString(); } catch { return '' + ts; }\n    };\n\n    const load = async () => {\n      refreshBtn.disabled = true;\n      refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0\u4E2D\u2026';\n      mountIcons(refreshBtn);\n      await bar.update();\n      list.innerHTML = '';\n      for (let i = 0; i < 3; i++) list.appendChild(html('<div class=\"skeleton\"></div>'));\n      try {\n        const [data, tpls] = await Promise.all([\n          NetworkManager.I.request<{ items: any[] }>('/items'),\n          NetworkManager.I.request<{ templates: any[] }>('/items/templates').catch(() => ({ templates: [] }))\n        ]);\n        const tplById: Record<string, any> = {};\n        for (const t of (tpls.templates || [])) tplById[t.id] = t;\n        list.innerHTML = '';\n        if (!data.items.length) {\n          list.appendChild(html('<div style=\"opacity:.8;\">\u6682\u65E0\u9053\u5177\uFF0C\u5C1D\u8BD5\u591A\u6316\u77FF\u6216\u63A0\u593A\u4EE5\u83B7\u53D6\u66F4\u591A\u8D44\u6E90</div>'));\n        }\n        for (const item of data.items) {\n          const tpl = tplById[item.templateId];\n          const rarity = getRarity(item, tpl);\n          const name = (tpl && (tpl.name || tpl.id)) || item.templateId;\n\n          const row = html(`\n            <div class=\"item-card hover-lift ${\n              rarity.key === 'legendary' ? 'rarity-outline-legendary' : rarity.key === 'epic' ? 'rarity-outline-epic' : rarity.key === 'rare' ? 'rarity-outline-rare' : 'rarity-outline-common'\n            }\" data-rarity=\"${rarity.key}\">\n              <div class=\"row\" style=\"justify-content:space-between;align-items:flex-start;gap:10px;\">\n                <div style=\"display:flex;flex-direction:column;gap:4px;flex:1;min-width:0;\">\n                  <div style=\"display:flex;flex-wrap:wrap;gap:6px;align-items:center;\">\n                    <strong style=\"font-size:15px;white-space:nowrap;display:flex;align-items:center;gap:6px;\"><span data-ico=\"ore\"></span>${name}</strong>\n                    <span class=\"badge rarity-${rarity.key}\"><i></i>${rarity.text}</span>\n                    ${item.isEquipped ? '<span class=\"pill\">\u5DF2\u88C5\u5907</span>' : ''}\n                    ${item.isListed ? '<span class=\"pill\">\u6302\u5355\u4E2D</span>' : ''}\n                  </div>\n                  <div style=\"opacity:.85;display:flex;flex-wrap:wrap;gap:8px;\">\n                    <span>\u7B49\u7EA7 Lv.${item.level}</span>\n                    <span class=\"pill\">\u5B9E\u4F8B ${item.id}</span>\n                    ${tpl?.category ? `<span class=\"pill\">${tpl.category}</span>` : ''}\n                  </div>\n                </div>\n                <div class=\"actions\">\n                  <button class=\"btn btn-buy\" data-act=\"equip\" data-id=\"${item.id}\" ${item.isEquipped ? 'disabled' : ''}><span data-ico=\"shield\"></span>\u88C5\u5907</button>\n                  <button class=\"btn btn-primary\" data-act=\"upgrade\" data-id=\"${item.id}\"><span data-ico=\"wrench\"></span>\u5347\u7EA7</button>\n                  <button class=\"btn btn-ghost\" data-act=\"toggle\" data-id=\"${item.id}\"><span data-ico=\"list\"></span>\u8BE6\u60C5</button>\n                </div>\n              </div>\n              <div class=\"timeline\" id=\"tl-${item.id}\" hidden></div>\n            </div>\n          `);\n          mountIcons(row);\n          row.addEventListener('click', async (ev) => {\n            const target = ev.target as HTMLButtonElement;\n            const id = target.getAttribute('data-id');\n            const act = target.getAttribute('data-act');\n            if (!id || !act) return;\n            if (act === 'toggle') {\n              const box = row.querySelector(`#tl-${id}`) as HTMLElement;\n              if (!box) return;\n              if (!box.hasChildNodes()) {\n                box.innerHTML = '<div class=\"skeleton\" style=\"height:36px;\"></div>';\n                box.hidden = false;\n                try {\n                  const res = await NetworkManager.I.request<{ logs: { type: string; desc?: string; time: number }[] }>(`/items/logs?itemId=${id}`);\n                  const logs = Array.isArray(res.logs) ? res.logs : [];\n                  box.innerHTML = '';\n                  if (!logs.length) {\n                    box.innerHTML = '<div style=\"opacity:.8;\">\u6682\u65E0\u5386\u53F2\u6570\u636E</div>';\n                  } else {\n                    for (const log of logs) {\n                      const node = html(`\n                        <div class=\"timeline-item\">\n                          <div class=\"dot\"></div>\n                          <div class=\"time\">${formatTime(log.time)}</div>\n                          <div class=\"desc\">${(log.desc || log.type || '').replace(/</g,'&lt;')}</div>\n                        </div>\n                      `);\n                      box.appendChild(node);\n                    }\n                  }\n                } catch {\n                  box.innerHTML = '';\n                  box.appendChild(html(`\n                    <div class=\"timeline-item\">\n                      <div class=\"dot\"></div>\n                      <div class=\"time\">\u2014</div>\n                      <div class=\"desc\">\u6765\u6E90\u672A\u77E5 \u00B7 \u53EF\u901A\u8FC7\u6316\u77FF\u3001\u63A0\u593A\u6216\u4EA4\u6613\u83B7\u53D6</div>\n                    </div>\n                  `));\n                }\n              } else {\n                box.hidden = !box.hidden;\n              }\n              return;\n            }\n            try {\n              target.disabled = true;\n              target.innerHTML = act === 'equip' ? '<span data-ico=\"shield\"></span>\u88C5\u5907\u4E2D\u2026' : '<span data-ico=\"wrench\"></span>\u5347\u7EA7\u4E2D\u2026';\n              mountIcons(target);\n              if (act === 'equip') {\n                await NetworkManager.I.request('/items/equip', { method: 'POST', body: JSON.stringify({ itemId: id }) });\n                showToast('\u88C5\u5907\u6210\u529F');\n              } else if (act === 'upgrade') {\n                await NetworkManager.I.request('/items/upgrade', { method: 'POST', body: JSON.stringify({ itemId: id }) });\n                showToast('\u5347\u7EA7\u6210\u529F');\n              }\n              await load();\n            } catch (e: any) {\n              showToast(e?.message || '\u64CD\u4F5C\u5931\u8D25');\n            } finally {\n              const a = target.getAttribute('data-act');\n              if (a === 'equip') target.innerHTML = '<span data-ico=\"shield\"></span>\u88C5\u5907';\n              else if (a === 'upgrade') target.innerHTML = '<span data-ico=\"wrench\"></span>\u5347\u7EA7';\n              else target.innerHTML = '<span data-ico=\"list\"></span>\u8BE6\u60C5';\n              mountIcons(target);\n              target.disabled = false;\n            }\n          });\n          list.appendChild(row);\n        }\n\n        tplContainer.innerHTML = '';\n        for (const tpl of (tpls.templates || [])) {\n          const row = html(`<div class=\"list-item\"><strong>${tpl.name || tpl.id}</strong> \u00B7 ${tpl.category || '\u672A\u77E5\u7C7B\u578B'}</div>`);\n          tplContainer.appendChild(row);\n        }\n      } catch (e: any) {\n        showToast(e?.message || '\u52A0\u8F7D\u4ED3\u5E93\u5931\u8D25');\n      } finally {\n        refreshBtn.disabled = false;\n        refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0';\n        mountIcons(refreshBtn);\n      }\n    };\n\n    refreshBtn.onclick = () => load();\n    await load();\n  }\n}\n", "import { NetworkManager } from '../core/NetworkManager';\nimport { html, qs } from '../utils/dom';\nimport { renderNav } from '../components/Nav';\nimport { RealtimeClient } from '../core/RealtimeClient';\nimport { showToast } from '../components/Toast';\nimport { renderResourceBar } from '../components/ResourceBar';\nimport { renderIcon } from '../components/Icon';\n\nexport class PlunderScene {\n  private resultBox: HTMLElement | null = null;\n\n  mount(root: HTMLElement) {\n    root.innerHTML = '';\n    root.appendChild(renderNav('plunder'));\n    const bar = renderResourceBar();\n    root.appendChild(bar.root);\n\n    const view = html(`\n      <div class=\"container grid-2\" style=\"color:#fff;\">\n        <div class=\"card fade-in\">\n          <div class=\"row\" style=\"justify-content:space-between;align-items:center;\">\n            <h3 style=\"margin:0;display:flex;align-items:center;gap:8px;\"><span data-ico=\"sword\"></span>\u63A0\u593A\u76EE\u6807</h3>\n            <button id=\"refresh\" class=\"btn btn-primary\"><span data-ico=\"refresh\"></span>\u5237\u65B0</button>\n          </div>\n          <div id=\"list\" style=\"margin-top:12px;display:flex;flex-direction:column;gap:8px;\"></div>\n          <div id=\"result\" style=\"margin-top:12px;opacity:.9;font-family:monospace;\"></div>\n        </div>\n      </div>\n    `);\n    root.appendChild(view);\n\n    const token = (NetworkManager as any).I['token'];\n    if (token) RealtimeClient.I.connect(token);\n\n    RealtimeClient.I.on('plunder.attacked', (msg) => {\n      showToast(`\u88AB\u63A0\u593A\uFF1A\u6765\u81EA ${msg.attacker}\uFF0C\u635F\u5931 ${msg.loss}`);\n      this.log(`\u88AB ${msg.attacker} \u63A0\u593A\uFF0C\u635F\u5931 ${msg.loss}`);\n    });\n    this.resultBox = qs(view, '#result');\n\n    const list = qs(view, '#list');\n    const refreshBtn = qs<HTMLButtonElement>(view, '#refresh');\n    const mountIcons = (rootEl: Element) => {\n      rootEl.querySelectorAll('[data-ico]')\n        .forEach((el) => {\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\n          try { el.appendChild(renderIcon(name, { size: 20 })); } catch {}\n        });\n    };\n    mountIcons(view);\n\n    const load = async () => {\n      refreshBtn.disabled = true;\n      refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0\u4E2D\u2026';\n      mountIcons(refreshBtn);\n      await bar.update();\n      list.innerHTML = '';\n      for (let i = 0; i < 3; i++) list.appendChild(html('<div class=\"skeleton\"></div>'));\n      try {\n        const data = await NetworkManager.I.request<{ targets: any[] }>('/plunder/targets');\n        list.innerHTML = '';\n        if (!data.targets.length) {\n          list.appendChild(html('<div style=\"opacity:.8;\">\u6682\u65E0\u53EF\u63A0\u593A\u7684\u76EE\u6807\uFF0C\u7A0D\u540E\u518D\u8BD5</div>'));\n        }\n        for (const target of data.targets) {\n          const row = html(`\n            <div class=\"list-item list-item--sell\">\n              <div style=\"display:flex;flex-direction:column;gap:2px;\">\n                <div style=\"display:flex;align-items:center;gap:6px;\"><span data-ico=\"target\"></span><strong>${target.username || target.id}</strong></div>\n                <div style=\"opacity:.85;\">\u77FF\u77F3\uFF1A${target.ore} <span class=\"pill\">\u9884\u8BA1\u6536\u76CA 5%~30%</span></div>\n              </div>\n              <div>\n                <button class=\"btn btn-sell\" data-id=\"${target.id}\"><span data-ico=\"sword\"></span>\u63A0\u593A</button>\n              </div>\n            </div>\n          `);\n          mountIcons(row);\n          row.addEventListener('click', async (ev) => {\n            const el = ev.target as HTMLButtonElement;\n            const id = el.getAttribute('data-id');\n            if (!id) return;\n            el.disabled = true;\n            const original = el.textContent || '';\n            el.textContent = '\u63A0\u593A\u4E2D\u2026';\n            try {\n              const res = await NetworkManager.I.request<{ success: boolean; loot_amount: number }>(`/plunder/${id}`, { method: 'POST' });\n              if (res.success) {\n                this.log(`\u6210\u529F\u63A0\u593A ${id}\uFF0C\u83B7\u5F97 ${res.loot_amount}`);\n                showToast(`\u63A0\u593A\u6210\u529F\uFF0C\u83B7\u5F97 ${res.loot_amount}`, 'success');\n              } else {\n                this.log(`\u63A0\u593A ${id} \u5931\u8D25`);\n                showToast('\u63A0\u593A\u5931\u8D25', 'warn');\n              }\n              await bar.update();\n            } catch (e: any) {\n              const message = e?.message || '\u63A0\u593A\u5931\u8D25';\n              this.log(`\u63A0\u593A\u5931\u8D25\uFF1A${message}`);\n              if (message.includes('\u51B7\u5374')) {\n                showToast('\u63A0\u593A\u5668\u51B7\u5374\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'warn');\n              } else {\n                showToast(message, 'error');\n              }\n            } finally {\n              el.textContent = original;\n              el.disabled = false;\n            }\n          });\n          list.appendChild(row);\n        }\n      } catch (e: any) {\n        showToast(e?.message || '\u52A0\u8F7D\u63A0\u593A\u76EE\u6807\u5931\u8D25');\n      } finally {\n        refreshBtn.disabled = false;\n        refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0';\n        mountIcons(refreshBtn);\n      }\n    };\n\n    refreshBtn.onclick = () => load();\n    load();\n  }\n\n  private log(msg: string) {\n    if (!this.resultBox) return;\n    const line = document.createElement('div');\n    line.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;\n    this.resultBox.prepend(line);\n  }\n}\n", "import { NetworkManager } from '../core/NetworkManager';\nimport { html, qs } from '../utils/dom';\nimport { renderNav } from '../components/Nav';\nimport { RealtimeClient } from '../core/RealtimeClient';\nimport { GameManager } from '../core/GameManager';\nimport { showToast } from '../components/Toast';\nimport { renderResourceBar } from '../components/ResourceBar';\nimport { renderIcon } from '../components/Icon';\n\ntype Order = {\n  id: string;\n  userId: string;\n  type: 'buy' | 'sell';\n  itemTemplateId?: string;\n  itemInstanceId?: string;\n  price: number;\n  amount: number;\n  createdAt: number;\n};\n\nexport class ExchangeScene {\n  private refreshTimer: number | null = null;\n  private templates: { id: string; name?: string; category?: string }[] = [];\n  private inventory: any[] = [];\n\n  async mount(root: HTMLElement) {\n    this.clearTimer();\n    root.innerHTML = '';\n\n    const nav = renderNav('exchange');\n    const bar = renderResourceBar();\n    const view = html(`\n      <div class=\"container grid-2\" style=\"color:#fff;\">\n        <div class=\"card fade-in\">\n          <h3 style=\"margin:0 0 12px;display:flex;align-items:center;gap:8px;\"><span data-ico=\"exchange\"></span>\u5E02\u573A\u4E0B\u5355</h3>\n          <div class=\"row\" style=\"flex-wrap:wrap;align-items:flex-end;gap:12px;\">\n            <div style=\"flex:1;min-width:180px;\">\n              <label style=\"display:flex;align-items:center;gap:6px;\"><span data-ico=\"list\"></span>\u8D2D\u4E70\u6A21\u677F</label>\n              <select id=\"tpl\" class=\"input\"></select>\n            </div>\n            <div style=\"flex:1;min-width:120px;\">\n              <label style=\"display:flex;align-items:center;gap:6px;\"><span data-ico=\"coin\"></span>\u4EF7\u683C (BB\u5E01)</label>\n              <input id=\"price\" class=\"input\" type=\"number\" min=\"1\" value=\"10\"/>\n            </div>\n            <div style=\"flex:1;min-width:120px;\">\n              <label>\u8D2D\u4E70\u6570\u91CF</label>\n              <input id=\"amount\" class=\"input\" type=\"number\" min=\"1\" value=\"1\"/>\n            </div>\n            <button id=\"placeBuy\" class=\"btn btn-buy\" style=\"min-width:120px;\"><span data-ico=\"arrow-right\"></span>\u4E0B\u4E70\u5355</button>\n          </div>\n          <div style=\"height:8px;\"></div>\n          <div class=\"row\" style=\"flex-wrap:wrap;align-items:flex-end;gap:12px;\">\n            <div style=\"flex:1;min-width:220px;\">\n              <label style=\"display:flex;align-items:center;gap:6px;\"><span data-ico=\"box\"></span>\u51FA\u552E\u9053\u5177</label>\n              <select id=\"inst\" class=\"input\"></select>\n            </div>\n            <div style=\"flex:1;min-width:120px;\">\n              <label style=\"display:flex;align-items:center;gap:6px;\"><span data-ico=\"coin\"></span>\u4EF7\u683C (BB\u5E01)</label>\n              <input id=\"sprice\" class=\"input\" type=\"number\" min=\"1\" value=\"5\"/>\n            </div>\n            <button id=\"placeSell\" class=\"btn btn-sell\" style=\"min-width:120px;\"><span data-ico=\"arrow-right\"></span>\u4E0B\u5356\u5355</button>\n          </div>\n          <div id=\"inventory\" style=\"margin-top:12px;display:flex;flex-wrap:wrap;gap:8px;\"></div>\n        </div>\n\n        <div class=\"card fade-in\">\n          <div class=\"row\" style=\"justify-content:space-between;align-items:center;gap:12px;\">\n            <h3 style=\"margin:0;display:flex;align-items:center;gap:8px;\"><span data-ico=\"list\"></span>\u8BA2\u5355\u7C3F</h3>\n            <div class=\"row\" style=\"flex-wrap:wrap;gap:8px;\">\n              <select id=\"q_tpl\" class=\"input\" style=\"width:180px;\"></select>\n              <select id=\"q_type\" class=\"input\" style=\"width:120px;\">\n                <option value=\"buy\">\u4E70\u5355</option>\n                <option value=\"sell\">\u5356\u5355</option>\n              </select>\n              <label class=\"row pill\" style=\"align-items:center;gap:6px;\">\n                <span data-ico=\"user\"></span>\n                <input id=\"my\" type=\"checkbox\"/> \u53EA\u770B\u6211\u7684\n              </label>\n              <button id=\"refresh\" class=\"btn btn-primary\" style=\"min-width:96px;\"><span data-ico=\"refresh\"></span>\u5237\u65B0</button>\n            </div>\n          </div>\n          <div id=\"book\" style=\"margin-top:12px;display:flex;flex-direction:column;gap:8px;\"></div>\n        </div>\n\n        <div class=\"card fade-in\" id=\"logs\" style=\"opacity:.9;font-family:monospace;min-height:24px;\"></div>\n      </div>\n    `);\n\n    root.appendChild(nav);\n    root.appendChild(bar.root);\n    root.appendChild(view);\n\n    const token = (NetworkManager as any).I['token'];\n    if (token) RealtimeClient.I.connect(token);\n    const me = GameManager.I.getProfile();\n\n    const book = qs(view, '#book');\n    const logs = qs<HTMLElement>(view, '#logs');\n    const buyTpl = qs<HTMLSelectElement>(view, '#tpl');\n    const buyPrice = qs<HTMLInputElement>(view, '#price');\n    const buyAmount = qs<HTMLInputElement>(view, '#amount');\n    const placeBuy = qs<HTMLButtonElement>(view, '#placeBuy');\n    const sellInst = qs<HTMLSelectElement>(view, '#inst');\n    const sellPrice = qs<HTMLInputElement>(view, '#sprice');\n    const placeSell = qs<HTMLButtonElement>(view, '#placeSell');\n    const invBox = qs<HTMLElement>(view, '#inventory');\n    const queryTpl = qs<HTMLSelectElement>(view, '#q_tpl');\n    const queryType = qs<HTMLSelectElement>(view, '#q_type');\n    const queryMineOnly = qs<HTMLInputElement>(view, '#my');\n    const mineOnlyLabel = view.querySelector('label.row.pill') as HTMLLabelElement | null;\n    const refreshBtn = qs<HTMLButtonElement>(view, '#refresh');\n\n    const mountIcons = (rootEl: Element) => {\n      rootEl.querySelectorAll('[data-ico]')\n        .forEach((el) => {\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\n          try { el.appendChild(renderIcon(name, { size: 20 })); } catch {}\n        });\n    };\n    mountIcons(view);\n\n    let prevIds = new Set<string>();\n    let refreshing = false;\n\n    const log = (message: string) => {\n      logs.textContent = message;\n    };\n\n    const renderTemplateOptions = () => {\n      buyTpl.innerHTML = '';\n      queryTpl.innerHTML = '';\n      const placeholder = html('<option value=\"\">\u9009\u62E9\u6A21\u677F</option>') as HTMLOptionElement;\n      buyTpl.appendChild(placeholder);\n      const qPlaceholder = html('<option value=\"\">\u5168\u90E8\u6A21\u677F</option>') as HTMLOptionElement;\n      queryTpl.appendChild(qPlaceholder);\n      for (const tpl of this.templates) {\n        const option = document.createElement('option');\n        option.value = tpl.id;\n        option.textContent = tpl.name ? `${tpl.name} (${tpl.id})` : tpl.id;\n        buyTpl.appendChild(option);\n        const qOption = option.cloneNode(true) as HTMLOptionElement;\n        queryTpl.appendChild(qOption);\n      }\n    };\n\n    const renderInventory = () => {\n      sellInst.innerHTML = '';\n      invBox.innerHTML = '';\n      const defaultOption = html('<option value=\"\">\u9009\u62E9\u53EF\u51FA\u552E\u7684\u9053\u5177</option>') as HTMLOptionElement;\n      sellInst.appendChild(defaultOption);\n      const available = this.inventory.filter((item) => !item.isEquipped && !item.isListed);\n      if (!available.length) {\n        invBox.textContent = '\u6682\u65E0\u53EF\u51FA\u552E\u7684\u9053\u5177\uFF08\u9700\u5148\u5728\u4ED3\u5E93\u5378\u4E0B\u88C5\u5907\uFF09';\n        return;\n      }\n      for (const item of available) {\n        const option = document.createElement('option');\n        option.value = item.id;\n        option.textContent = `${item.id} \u00B7 ${item.templateId} \u00B7 Lv.${item.level}`;\n        sellInst.appendChild(option);\n\n        const chip = html(`<button class=\"btn btn-ghost\" style=\"flex:unset;padding:6px 10px;\" data-id=\"${item.id}\">${item.id} (${item.templateId})</button>`) as HTMLButtonElement;\n        chip.onclick = () => {\n          sellInst.value = item.id;\n          log(`\u5DF2\u9009\u62E9\u51FA\u552E\u9053\u5177 ${item.id}`);\n        };\n        invBox.appendChild(chip);\n      }\n    };\n\n    const loadMetadata = async () => {\n      try {\n        const [tpls, items] = await Promise.all([\n          NetworkManager.I.request<{ templates: any[] }>('/items/templates'),\n          NetworkManager.I.request<{ items: any[] }>('/items'),\n        ]);\n        this.templates = tpls.templates || [];\n        this.inventory = items.items || [];\n        renderTemplateOptions();\n        renderInventory();\n      } catch (e: any) {\n        log(e?.message || '\u52A0\u8F7D\u6A21\u677F/\u4ED3\u5E93\u5931\u8D25');\n      }\n    };\n\n    const refresh = async (opts: { quiet?: boolean } = {}) => {\n      if (refreshing) return;\n      refreshing = true;\n      if (!opts.quiet) { refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0\u4E2D\u2026'; mountIcons(refreshBtn); }\n      refreshBtn.disabled = true;\n      try {\n        const tplId = queryTpl.value;\n        const type = queryType.value as 'buy' | 'sell';\n        const mineOnly = queryMineOnly.checked;\n        const params = new URLSearchParams();\n        params.set('type', type);\n        params.set('item_template_id', tplId || '');\n        if (!opts.quiet) {\n          book.innerHTML = '';\n          for (let i = 0; i < 4; i++) book.appendChild(html('<div class=\"skeleton\"></div>'));\n        }\n        const data = await NetworkManager.I.request<{ orders: Order[] }>(`/exchange/orders?${params.toString()}`);\n        const newIds = new Set<string>();\n        book.innerHTML = '';\n        const orders = data.orders || [];\n        if (!orders.length) {\n          book.appendChild(html('<div style=\"opacity:.8;text-align:center;\">\u6682\u65E0\u8BA2\u5355</div>'));\n        }\n        for (const order of orders) {\n          if (mineOnly && me && order.userId !== me.id) continue;\n          newIds.add(order.id);\n          const isMine = me && order.userId === me.id;\n          const klass = `list-item ${order.type === 'buy' ? 'list-item--buy' : 'list-item--sell'}`;\n          const row = html(`\n            <div class=\"${klass}\">\n              <div style=\"display:flex;flex-direction:column;gap:2px;\">\n                <div>\n                  <strong>${order.type === 'buy' ? '\u4E70\u5165' : '\u5356\u51FA'}</strong>\n                  ${order.itemTemplateId || ''}\n                  ${isMine ? '<span class=\"pill\">\u6211\u7684</span>' : ''}\n                </div>\n                <div style=\"opacity:.85;\">\n                  \u4EF7\u683C: ${order.price} \u00B7 \u6570\u91CF: ${order.amount}\n                  ${order.itemInstanceId ? `<span class=\"pill\">${order.itemInstanceId}</span>` : ''}\n                  <span class=\"pill\">${order.id}</span>\n                </div>\n              </div>\n              <div>\n                ${isMine ? `<button class=\"btn btn-ghost\" data-id=\"${order.id}\"><span data-ico=\"trash\"></span>\u64A4\u5355</button>` : ''}\n              </div>\n            </div>\n          `);\n          mountIcons(row);\n          if (!prevIds.has(order.id)) row.classList.add('flash');\n          row.addEventListener('click', async (ev) => {\n            const target = ev.target as HTMLElement;\n            const id = target.getAttribute('data-id');\n            if (!id) return;\n            try {\n              target.setAttribute('disabled', 'true');\n              await NetworkManager.I.request(`/exchange/orders/${id}`, { method: 'DELETE' });\n              showToast('\u64A4\u5355\u6210\u529F', 'success');\n              await refresh();\n            } catch (e: any) {\n              showToast(e?.message || '\u64A4\u5355\u5931\u8D25', 'error');\n            } finally {\n              target.removeAttribute('disabled');\n            }\n          });\n          book.appendChild(row);\n        }\n        prevIds = newIds;\n        if (!book.childElementCount) {\n          book.appendChild(html('<div style=\"opacity:.8;text-align:center;\">\u6682\u65E0\u7B26\u5408\u6761\u4EF6\u7684\u8BA2\u5355</div>'));\n        }\n      } catch (e: any) {\n        log(e?.message || '\u5237\u65B0\u8BA2\u5355\u5931\u8D25');\n      } finally {\n        refreshing = false;\n        refreshBtn.disabled = false;\n        refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0';\n        mountIcons(refreshBtn);\n      }\n    };\n\n    placeBuy.onclick = async () => {\n      const tplId = buyTpl.value.trim();\n      const price = Number(buyPrice.value);\n      const amount = Number(buyAmount.value);\n      if (!tplId) {\n        showToast('\u8BF7\u9009\u62E9\u8D2D\u4E70\u7684\u6A21\u677F', 'warn');\n        return;\n      }\n      if (price <= 0 || amount <= 0) {\n        showToast('\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4EF7\u683C\u4E0E\u6570\u91CF', 'warn');\n        return;\n      }\n      placeBuy.disabled = true;\n      placeBuy.textContent = '\u63D0\u4EA4\u4E2D\u2026';\n      try {\n        const res = await NetworkManager.I.request<{ id: string }>('/exchange/orders', {\n          method: 'POST',\n          body: JSON.stringify({ type: 'buy', item_template_id: tplId, price, amount }),\n        });\n        showToast(`\u4E70\u5355\u5DF2\u63D0\u4EA4 (#${res.id})`, 'success');\n        log(`\u4E70\u5355\u6210\u529F: ${res.id}`);\n        await bar.update();\n        await refresh();\n      } catch (e: any) {\n        showToast(e?.message || '\u4E70\u5355\u63D0\u4EA4\u5931\u8D25', 'error');\n        log(e?.message || '\u4E70\u5355\u63D0\u4EA4\u5931\u8D25');\n      } finally {\n        placeBuy.disabled = false;\n        placeBuy.textContent = '\u4E0B\u4E70\u5355';\n      }\n    };\n\n    placeSell.onclick = async () => {\n      const instId = sellInst.value.trim();\n      const price = Number(sellPrice.value);\n      if (!instId) {\n        showToast('\u8BF7\u9009\u62E9\u8981\u51FA\u552E\u7684\u9053\u5177', 'warn');\n        return;\n      }\n      if (price <= 0) {\n        showToast('\u8BF7\u8F93\u5165\u6709\u6548\u7684\u4EF7\u683C', 'warn');\n        return;\n      }\n      placeSell.disabled = true;\n      placeSell.textContent = '\u63D0\u4EA4\u4E2D\u2026';\n      try {\n        const res = await NetworkManager.I.request<{ id: string }>('/exchange/orders', {\n          method: 'POST',\n          body: JSON.stringify({ type: 'sell', item_instance_id: instId, price }),\n        });\n        showToast(`\u5356\u5355\u5DF2\u63D0\u4EA4 (#${res.id})`, 'success');\n        log(`\u5356\u5355\u6210\u529F: ${res.id}`);\n        await bar.update();\n        await loadMetadata();\n        await refresh();\n      } catch (e: any) {\n        showToast(e?.message || '\u5356\u5355\u63D0\u4EA4\u5931\u8D25', 'error');\n        log(e?.message || '\u5356\u5355\u63D0\u4EA4\u5931\u8D25');\n      } finally {\n        placeSell.disabled = false;\n        placeSell.textContent = '\u4E0B\u5356\u5355';\n      }\n    };\n\n    refreshBtn.onclick = () => refresh();\n    queryTpl.onchange = () => refresh();\n    queryType.onchange = () => refresh();\n    queryMineOnly.onchange = () => { if (mineOnlyLabel) mineOnlyLabel.classList.toggle('active', queryMineOnly.checked); refresh(); };\n    if (mineOnlyLabel) mineOnlyLabel.classList.toggle('active', queryMineOnly.checked);\n\n    await Promise.all([bar.update(), loadMetadata()]);\n    await refresh({ quiet: true });\n    this.refreshTimer = window.setInterval(() => {\n      refresh({ quiet: true }).catch(() => {});\n    }, 10000);\n  }\n\n  private clearTimer() {\n    if (this.refreshTimer !== null) {\n      window.clearInterval(this.refreshTimer);\n      this.refreshTimer = null;\n    }\n  }\n}\n", "import { NetworkManager } from '../core/NetworkManager';\nimport { html, qs } from '../utils/dom';\nimport { renderNav } from '../components/Nav';\nimport { RealtimeClient } from '../core/RealtimeClient';\nimport { renderResourceBar } from '../components/ResourceBar';\nimport { renderIcon } from '../components/Icon';\n\nexport class RankingScene {\n  mount(root: HTMLElement) {\n    root.innerHTML = '';\n    root.appendChild(renderNav('ranking'));\n    const bar = renderResourceBar();\n    root.appendChild(bar.root);\n\n    const view = html(`\n      <div class=\"container grid-2\" style=\"color:#fff;\">\n        <div class=\"card fade-in\">\n          <div class=\"row\" style=\"justify-content:space-between;align-items:center;\">\n            <h3 style=\"margin:0;display:flex;align-items:center;gap:8px;\"><span data-ico=\"trophy\"></span>\u6392\u884C\u699C</h3>\n            <button id=\"refresh\" class=\"btn btn-primary\"><span data-ico=\"refresh\"></span>\u5237\u65B0</button>\n          </div>\n          <div id=\"me\" style=\"margin-top:8px;opacity:.95;\"></div>\n          <div id=\"list\" style=\"margin-top:12px;display:flex;flex-direction:column;gap:6px;\"></div>\n        </div>\n      </div>\n    `);\n    root.appendChild(view);\n\n    const token = (NetworkManager as any).I['token'];\n    if (token) RealtimeClient.I.connect(token);\n\n    const meBox = qs(view, '#me');\n    const list = qs(view, '#list');\n    const refreshBtn = qs<HTMLButtonElement>(view, '#refresh');\n    const mountIcons = (rootEl: Element) => {\n      rootEl.querySelectorAll('[data-ico]')\n        .forEach((el) => {\n          const name = (el as HTMLElement).getAttribute('data-ico') as any;\n          try { el.appendChild(renderIcon(name, { size: 20 })); } catch {}\n        });\n    };\n    mountIcons(view);\n\n    const load = async () => {\n      refreshBtn.disabled = true;\n      refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0\u4E2D\u2026';\n      mountIcons(refreshBtn);\n      await bar.update();\n      list.innerHTML = '';\n      for (let i = 0; i < 3; i++) list.appendChild(html('<div class=\"skeleton\"></div>'));\n      try {\n        const me = await NetworkManager.I.request<{ rank: number; score: number }>('/ranking/me');\n        const top = await NetworkManager.I.request<{ list: any[] }>('/ranking/top?n=20');\n        meBox.textContent = `\u6211\u7684\u540D\u6B21\uFF1A#${me.rank} \u00B7 \u603B\u5F97\u5206\uFF1A${me.score}`;\n        list.innerHTML = '';\n        for (const entry of top.list) {\n          const medal = entry.rank === 1 ? '\uD83E\uDD47' : entry.rank === 2 ? '\uD83E\uDD48' : entry.rank === 3 ? '\uD83E\uDD49' : '';\n          const cls = entry.rank <= 3 ? ' list-item--buy' : '';\n          const row = html(`\n            <div class=\"list-item${cls}\">\n              <span>${medal} #${entry.rank}</span>\n              <span style=\"flex:1;opacity:.9;margin-left:12px;display:flex;align-items:center;gap:6px;\"><span data-ico=\"user\"></span>${entry.userId}</span>\n              <strong>${entry.score}</strong>\n            </div>\n          `);\n          mountIcons(row);\n          list.appendChild(row);\n        }\n      } catch (e: any) {\n        meBox.textContent = e?.message || '\u6392\u884C\u699C\u52A0\u8F7D\u5931\u8D25';\n      } finally {\n        refreshBtn.disabled = false;\n        refreshBtn.innerHTML = '<span data-ico=\"refresh\"></span>\u5237\u65B0';\n        mountIcons(refreshBtn);\n      }\n    };\n    refreshBtn.onclick = () => load();\n    load();\n  }\n}\n", "let injected = false;\r\n\r\nexport function ensureGlobalStyles() {\r\n  if (injected) return;\r\n  const css = `:root{--bg:#0b1020;--bg-2:#0f1530;--fg:#fff;--muted:rgba(255,255,255,.75);--grad:linear-gradient(135deg,#7B2CF5,#2C89F5);--panel-grad:linear-gradient(135deg,rgba(123,44,245,.25),rgba(44,137,245,.25));--glass:blur(10px);--glow:0 8px 20px rgba(0,0,0,.35),0 0 12px rgba(123,44,245,.7);--radius-sm:10px;--radius-md:12px;--radius-lg:16px;--ease:cubic-bezier(.22,.61,.36,1);--dur:.28s;--buy:#2C89F5;--sell:#E36414;--ok:#2ec27e;--warn:#f6c445;--danger:#ff5c5c;--rarity-common:#9aa0a6;--rarity-rare:#4fd4f5;--rarity-epic:#b26bff;--rarity-legendary:#f6c445;--container-max:720px}\r\nhtml,body{background:radial-gradient(1200px 600px at 50% -10%, rgba(123,44,245,.12), transparent),var(--bg);color:var(--fg);font-family:system-ui,-apple-system,\"Segoe UI\",\"PingFang SC\",\"Microsoft YaHei\",Arial,sans-serif}\r\nhtml{color-scheme:dark}\r\n.container{padding:0 12px}\r\n.container{max-width:var(--container-max);margin:12px auto}\r\n.card{position:relative;border-radius:var(--radius-lg);background:var(--panel-grad);backdrop-filter:var(--glass);box-shadow:var(--glow);padding:12px;overflow:hidden}\r\n/* neon corners + sheen */\r\n.card::before{content:\"\";position:absolute;inset:0;border-radius:inherit;background:radial-gradient(40% 25% at 100% 0, rgba(123,44,245,.18), transparent 60%),radial-gradient(35% 25% at 0 100%, rgba(44,137,245,.16), transparent 60%);pointer-events:none}\r\n.card::after{content:\"\";position:absolute;left:-30%;top:-120%;width:60%;height:300%;background:linear-gradient(120deg,transparent,rgba(255,255,255,.18),transparent);transform:rotate(8deg);opacity:.25;animation:card-sheen 9s linear infinite}\r\n@keyframes card-sheen{0%{transform:translateX(0) rotate(8deg)}100%{transform:translateX(160%) rotate(8deg)}}\r\n.row{display:flex;gap:8px;align-items:center}\r\n.card input,.card button{box-sizing:border-box;outline:none}\r\n.card input{background:rgba(255,255,255,.08);border:0;border-radius:var(--radius-md);color:var(--fg);padding:10px;margin:8px 0;appearance:none;-webkit-appearance:none;background-clip:padding-box}\r\n.card select.input, select.input{background:rgba(255,255,255,.08);color:var(--fg);border:0;border-radius:var(--radius-md);padding:10px;margin:8px 0;appearance:none;-webkit-appearance:none;background-clip:padding-box}\r\n.card select.input option, select.input option{background:#0b1020;color:#fff}\r\n.card select.input:focus, select.input:focus{outline:2px solid rgba(123,44,245,.45)}\r\n.card button{width:100%;border-radius:var(--radius-md)}\r\n.btn{position:relative;overflow:hidden;padding:10px 14px;border:0;border-radius:var(--radius-md);color:#fff;transition:transform var(--dur) var(--ease),box-shadow var(--dur) var(--ease),filter var(--dur) var(--ease)}\r\n.btn .icon{margin-right:6px}\r\n.btn:active{transform:translateY(1px) scale(.99)}\r\n.btn::after{content:\"\";position:absolute;inset:0;opacity:0;background:linear-gradient(115deg,transparent,rgba(255,255,255,.25),transparent 55%);transform:translateX(-60%);transition:opacity var(--dur) var(--ease), transform var(--dur) var(--ease)}\r\n.btn:hover::after{opacity:.9;transform:translateX(0)}\r\n.btn:hover{filter:saturate(110%)}\r\n.btn-primary{background:var(--grad);box-shadow:var(--glow)}\r\n.btn-buy{background:var(--buy)}\r\n.btn-sell{background:var(--sell)}\r\n.btn-ghost{background:rgba(255,255,255,.08)}\r\n.input{width:100%;padding:10px;border:0;border-radius:var(--radius-md);background:rgba(255,255,255,.08);color:var(--fg)}\r\n.pill{padding:2px 8px;border-radius:999px;background:rgba(255,255,255,.08);font-size:12px;cursor:pointer}\r\n.pill.active{background:linear-gradient(135deg, rgba(123,44,245,.35), rgba(44,137,245,.28));box-shadow:var(--glow)}\r\n.scene-header{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-bottom:8px}\r\n.scene-header h1{margin:0;font-size:20px}\r\n.scene-header p{margin:0;opacity:.85}\r\n.stats{display:flex;gap:10px}\r\n.stat{flex:1;min-width:0;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));border-radius:12px;padding:10px;display:flex;align-items:center;gap:10px}\r\n.stat .ico{font-size:18px;filter:drop-shadow(0 0 8px rgba(123,44,245,.35))}\r\n.stat .val{font-weight:700;font-size:16px}\r\n.stat .label{opacity:.85;font-size:12px}\r\n.event-feed{max-height:240px;overflow:auto;display:flex;flex-direction:column;gap:6px}\r\n.event-feed .event{opacity:.9;font-family:monospace;font-size:12px}\r\n.main-screen{position:relative;padding:12px 0 36px;min-height:100vh}\n.main-stack{display:flex;flex-direction:column;gap:16px}\n.mine-card{min-height:calc(100vh - 160px);padding:24px 20px;display:flex;flex-direction:column;gap:20px;border-radius:20px}\n@media (min-width:580px){.mine-card{min-height:620px;padding:28px 26px}}\n.mine-header{display:flex;align-items:center;justify-content:space-between;gap:12px}\n.mine-title{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:600;letter-spacing:.04em;text-shadow:0 2px 12px rgba(18,10,48,.6)}\n.mine-title .icon{filter:drop-shadow(0 0 12px rgba(124,60,255,.55))}\n.mine-chips{display:flex;align-items:center;gap:8px}\n.mine-chips .pill{display:flex;align-items:center;gap:6px;font-size:12px;background:rgba(15,24,56,.55);box-shadow:inset 0 0 0 1px rgba(123,44,245,.25)}\n.mine-grid{display:grid;gap:18px}\n@media (min-width:640px){.mine-grid{grid-template-columns:220px 1fr;align-items:center}}\n.mine-gauge{position:relative;display:flex;align-items:center;justify-content:center;padding:8px 0}\n.mine-gauge .ring{width:200px;aspect-ratio:1;border-radius:50%;display:flex;align-items:center;justify-content:center;background:conic-gradient(#7B2CF5 0deg,rgba(255,255,255,.08) 0deg);box-shadow:inset 0 0 30px rgba(123,44,245,.28),0 24px 48px rgba(12,8,42,.55)}\n.mine-gauge .ring::before{content:\"\";position:absolute;inset:18%;border-radius:50%;background:radial-gradient(circle at 50% 28%,rgba(123,44,245,.45),rgba(12,20,46,.92) 70%);box-shadow:inset 0 14px 28px rgba(0,0,0,.48)}\n.mine-gauge .ring-core{position:relative;display:flex;flex-direction:column;align-items:center;gap:4px;font-weight:600}\n.mine-gauge .ring-core span{font-size:22px}\n.mine-gauge .ring-core small{font-size:12px;letter-spacing:.12em;opacity:.75;text-transform:uppercase}\n.ring-glow{position:absolute;width:200px;height:200px;border-radius:50%;filter:blur(32px);background:radial-gradient(circle,rgba(123,44,245,.48),rgba(44,137,245,.1));opacity:.6;animation:mine-glow 9s ease-in-out infinite}\n.ring-glow-b{animation-delay:-4.5s;background:radial-gradient(circle,rgba(44,137,245,.45),transparent 65%)}\n@keyframes mine-glow{0%,100%{transform:scale(.92);opacity:.45}50%{transform:scale(1.05);opacity:.8}}\n.mine-progress{display:flex;flex-direction:column;gap:14px}\n.mine-progress-meta{display:flex;align-items:flex-end;justify-content:space-between;font-size:14px;letter-spacing:.02em}\n.mine-progress-track{position:relative;height:12px;border-radius:999px;background:rgba(255,255,255,.1);overflow:hidden;box-shadow:inset 0 0 14px rgba(123,44,245,.28)}\n.mine-progress-fill{height:100%;width:0;background:linear-gradient(90deg,#7B2CF5,#2C89F5);box-shadow:0 0 16px rgba(123,44,245,.65);transition:width .35s var(--ease)}\n.mine-status{min-height:22px;font-size:13px;opacity:.9}\n.mine-actions-grid{display:grid;gap:12px;grid-template-columns:repeat(2,minmax(0,1fr))}\n.mine-actions-grid .btn{height:48px;display:flex;align-items:center;justify-content:center;font-size:15px;gap:8px}\n.mine-actions-grid .span-2{grid-column:span 2}\n@media (min-width:680px){.mine-actions-grid{grid-template-columns:repeat(3,minmax(0,1fr))}.mine-actions-grid .span-2{grid-column:span 3}}\n.mine-feed{position:relative;border-radius:16px;background:rgba(12,20,44,.55);padding:14px 12px;box-shadow:inset 0 0 24px rgba(123,44,245,.12);backdrop-filter:blur(12px)}\n.mine-feed::before{content:\"\";position:absolute;inset:0;pointer-events:none;background:linear-gradient(135deg,rgba(123,44,245,.16),rgba(44,137,245,.14) 60%,transparent);opacity:.75}\n.mine-feed .event-feed{max-height:180px}\n.mine-hologram{position:relative;flex:1;min-height:180px;border-radius:18px;background:radial-gradient(90% 120% at 50% 100%,rgba(44,137,245,.35),rgba(8,12,30,.3) 55%,transparent);overflow:hidden;margin-top:auto;display:flex;align-items:center;justify-content:center;isolation:isolate}\n.mine-holo-grid{position:absolute;width:140%;height:140%;background:repeating-linear-gradient(0deg,rgba(255,255,255,.08) 0,rgba(255,255,255,.08) 1px,transparent 1px,transparent 28px),repeating-linear-gradient(90deg,rgba(255,255,255,.05) 0,rgba(255,255,255,.05) 1px,transparent 1px,transparent 26px);opacity:.22;transform:translate3d(-10%,0,0) rotate(8deg);animation:holo-pan 16s linear infinite}\n.mine-holo-grid.diagonal{opacity:.18;transform:translate3d(10%,0,0) rotate(-16deg);animation-duration:22s}\n@keyframes holo-pan{0%{transform:translate3d(-12%,0,0) rotate(8deg)}100%{transform:translate3d(12%,0,0) rotate(8deg)}}\n.mine-holo-glow{position:absolute;width:70%;height:70%;border-radius:50%;background:radial-gradient(circle at 50% 40%,rgba(123,44,245,.55),transparent 70%);filter:blur(32px);opacity:.55;animation:holo-breathe 10s ease-in-out infinite}\n@keyframes holo-breathe{0%,100%{transform:scale(.9);opacity:.45}50%{transform:scale(1.08);opacity:.85}}\n.mine-shard{position:absolute;width:120px;height:120px;background:conic-gradient(from 150deg,rgba(123,44,245,.8),rgba(44,137,245,.38),rgba(123,44,245,.08));clip-path:polygon(50% 0,88% 40%,70% 100%,30% 100%,12% 40%);opacity:.26;filter:blur(.4px);animation:shard-float 8s ease-in-out infinite}\n.mine-shard.shard-1{top:18%;left:16%;animation-delay:-1.4s}\n.mine-shard.shard-2{bottom:16%;right:22%;animation-delay:-3.2s;transform:scale(.74)}\n.mine-shard.shard-3{top:26%;right:34%;animation-delay:-5.1s;transform:scale(.5) rotate(12deg)}\n@keyframes shard-float{0%,100%{transform:translateY(-10px) scale(1);opacity:.2}50%{transform:translateY(10px) scale(1.05);opacity:.4}}\n.main-ambient{position:absolute;inset:0;z-index:-1;pointer-events:none;overflow:hidden}\n.main-ambient .ambient.orb{position:absolute;width:420px;height:420px;border-radius:50%;filter:blur(120px);opacity:.42;animation:ambient-drift 26s ease-in-out infinite}\n.main-ambient .orb-a{background:radial-gradient(circle,rgba(123,44,245,.6),transparent 70%);top:-140px;right:-120px}\n.main-ambient .orb-b{background:radial-gradient(circle,rgba(44,137,245,.55),transparent 70%);bottom:-180px;left:-180px;animation-delay:-13s}\n.main-ambient .grid{position:absolute;inset:0;background:radial-gradient(70% 60% at 50% 100%,rgba(255,255,255,.08),transparent 75%);opacity:.35;mix-blend-mode:screen;animation:ambient-pulse 18s ease-in-out infinite}\n@keyframes ambient-drift{0%,100%{transform:translate3d(0,0,0) scale(1)}50%{transform:translate3d(8%, -4%,0) scale(1.05)}}\n@keyframes ambient-pulse{0%,100%{opacity:.25}50%{opacity:.45}}\r\n.fade-in{animation:fade-in .3s var(--ease)}\r\n@keyframes fade-in{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}\r\n.flash{animation:flash .9s ease}\r\n@keyframes flash{0%{box-shadow:0 0 0 rgba(255,255,255,0)}40%{box-shadow:0 0 0 6px rgba(255,255,255,.15)}100%{box-shadow:0 0 0 rgba(255,255,255,0)}}\r\n.skeleton{position:relative;overflow:hidden;background:rgba(255,255,255,.08);border-radius:var(--radius-md);height:44px}\r\n.skeleton::after{content:\"\";position:absolute;inset:0;transform:translateX(-100%);background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent);animation:shimmer 1.2s infinite}\r\n@keyframes shimmer{100%{transform:translateX(100%)}}\r\n.list-item{display:flex;gap:8px;align-items:center;justify-content:space-between;background:rgba(255,255,255,.06);border-radius:var(--radius-md);padding:10px}\r\n.list-item--buy{border-left:3px solid var(--buy)}\r\n.list-item--sell{border-left:3px solid var(--sell)}\r\n.nav{max-width:var(--container-max);margin:12px auto 0;display:flex;gap:8px;flex-wrap:wrap;position:sticky;top:0;z-index:40;padding:6px;border-radius:14px;background:linear-gradient(180deg,rgba(20,20,40,.45),rgba(20,20,40,.25));backdrop-filter:blur(10px) saturate(125%);border:1px solid rgba(255,255,255,.06)}\r\n.nav a{flex:1;display:flex;justify-content:center;align-items:center;gap:6px;text-align:center;padding:10px;border-radius:999px;text-decoration:none;color:#fff;transition:background var(--dur) var(--ease), transform var(--dur) var(--ease)}\r\n.nav a .ico{opacity:.95}\r\n.nav a.active{background:var(--grad);box-shadow:var(--glow)}\r\n.nav a:not(.active):hover{background:rgba(255,255,255,.06)}\r\n/* generic icon */\r\n.icon{display:inline-block;line-height:0;vertical-align:middle}\r\n.icon svg{display:block;filter:drop-shadow(0 0 8px rgba(123,44,245,.35))}\r\n/* rarity badges */\r\n.badge{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border-radius:999px;font-size:12px;line-height:1;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06)}\r\n.badge i{display:inline-block;width:8px;height:8px;border-radius:999px}\r\n.badge.rarity-common i{background:var(--rarity-common)}\r\n.badge.rarity-rare i{background:var(--rarity-rare)}\r\n.badge.rarity-epic i{background:var(--rarity-epic)}\r\n.badge.rarity-legendary i{background:var(--rarity-legendary)}\r\n.rarity-outline-common{box-shadow:0 0 0 1px rgba(154,160,166,.35) inset, 0 0 24px rgba(154,160,166,.15)}\r\n.rarity-outline-rare{box-shadow:0 0 0 1px rgba(79,212,245,.45) inset, 0 0 28px rgba(79,212,245,.25)}\r\n.rarity-outline-epic{box-shadow:0 0 0 1px rgba(178,107,255,.5) inset, 0 0 32px rgba(178,107,255,.3)}\r\n.rarity-outline-legendary{box-shadow:0 0 0 1px rgba(246,196,69,.6) inset, 0 0 36px rgba(246,196,69,.35)}\r\n/* aura card wrapper */\r\n.item-card{position:relative;border-radius:var(--radius-md);padding:10px;background:linear-gradient(140deg,rgba(255,255,255,.06),rgba(255,255,255,.04));overflow:hidden}\r\n.item-card::before{content:\"\";position:absolute;inset:-1px;border-radius:inherit;padding:1px;background:linear-gradient(135deg,rgba(255,255,255,.18),rgba(255,255,255,.02));-webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);-webkit-mask-composite:xor;mask-composite:exclude}\r\n.item-card[data-rarity=\"common\"]{border:1px solid rgba(154,160,166,.25)}\r\n.item-card[data-rarity=\"rare\"]{border:1px solid rgba(79,212,245,.35)}\r\n.item-card[data-rarity=\"epic\"]{border:1px solid rgba(178,107,255,.4)}\r\n.item-card[data-rarity=\"legendary\"]{border:1px solid rgba(246,196,69,.45)}\r\n/* vertical timeline */\r\n.timeline{position:relative;margin-top:8px;padding-left:16px}\r\n.timeline::before{content:\"\";position:absolute;left:6px;top:0;bottom:0;width:2px;background:rgba(255,255,255,.1)}\r\n.timeline-item{position:relative;margin:8px 0 8px 0}\r\n.timeline-item .dot{position:absolute;left:-12px;top:2px;width:10px;height:10px;border-radius:999px;background:var(--rarity-rare);box-shadow:0 0 10px rgba(79,212,245,.5)}\r\n.timeline-item .time{opacity:.75;font-size:12px}\r\n.timeline-item .desc{margin-top:2px}\r\n/* action buttons line */\r\n.actions{display:flex;gap:6px;flex-wrap:wrap}\r\n/* subtle hover */\r\n.hover-lift{transition:transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease)}\r\n.hover-lift:hover{transform:translateY(-1px)}\r\n/* ring meter */\r\n.ring{--size:116px;--thick:10px;position:relative;width:var(--size);height:var(--size);border-radius:50%;background:conic-gradient(#7B2CF5 0deg, rgba(255,255,255,.08) 0deg)}\r\n.ring::after{content:\"\";position:absolute;inset:calc(var(--thick));border-radius:inherit;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02))}\r\n.ring .label{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:700}\r\n/* toast */\r\n.toast-wrap{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:8px;z-index:9999}\r\n.toast{max-width:340px;padding:10px 12px;border-radius:12px;color:#fff;background:rgba(30,30,50,.96);box-shadow:var(--glow);position:relative;overflow:hidden}\r\n.toast.success{background:linear-gradient(180deg,rgba(46,194,126,.16),rgba(30,30,50,.96))}\r\n.toast.warn{background:linear-gradient(180deg,rgba(246,196,69,.18),rgba(30,30,50,.96))}\r\n.toast.error{background:linear-gradient(180deg,rgba(255,92,92,.18),rgba(30,30,50,.96))}\r\n.toast .life{position:absolute;left:0;bottom:0;height:2px;background:#7B2CF5;animation:toast-life var(--life,3.5s) linear forwards}\r\n@keyframes toast-life{from{width:100%}to{width:0}}\r\n@media (prefers-reduced-motion:reduce){*{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:0ms!important}}\r\n\r\n/* responsive width + desktop grid layout for fullness */\r\n@media (min-width:900px){:root{--container-max:920px}}\r\n@media (min-width:1200px){:root{--container-max:1080px}}\r\n\r\n.container.grid-2{display:grid;grid-template-columns:1fr;gap:12px}\r\n@media (min-width:980px){\r\n  .container.grid-2{grid-template-columns:1fr 1fr;align-items:start}\r\n  .container.grid-2>.card:first-child{grid-column:1/-1}\r\n}\r\n\r\n/* decorative page overlays: aurora, grid lines, bottom glow */\r\nhtml::before{content:\"\";position:fixed;inset:0;pointer-events:none;z-index:-2;opacity:.035;background-image:linear-gradient(rgba(255,255,255,.04) 1px, transparent 1px),linear-gradient(90deg, rgba(255,255,255,.04) 1px, transparent 1px);background-size:24px 24px}\r\nbody::before{content:\"\";position:fixed;right:-10vw;top:-18vh;width:70vw;height:70vh;pointer-events:none;z-index:-1;filter:blur(50px);opacity:.55;background:radial-gradient(closest-side at 25% 40%, rgba(123,44,245,.35), transparent 65%), radial-gradient(closest-side at 70% 60%, rgba(44,137,245,.25), transparent 70%);mix-blend-mode:screen;animation:aurora-a 18s ease-in-out infinite alternate}\r\nbody::after{content:\"\";position:fixed;left:-10vw;bottom:-22vh;width:120vw;height:60vh;pointer-events:none;z-index:-1;filter:blur(60px);opacity:.75;background:radial-gradient(120vw 60vh at 50% 100%, rgba(44,137,245,.22), transparent 65%), conic-gradient(from 200deg at 50% 75%, rgba(123,44,245,.18), rgba(44,137,245,.12), transparent 70%);mix-blend-mode:screen;animation:aurora-b 22s ease-in-out infinite alternate}\r\n@keyframes aurora-a{0%{transform:translateY(0)}100%{transform:translateY(14px)}}\r\n@keyframes aurora-b{0%{transform:translateY(0)}100%{transform:translateY(-12px)}}\r\n`;\r\n  const style = document.createElement('style');\r\n  style.setAttribute('data-ui', 'miner-game');\r\n  style.textContent = css;\r\n  document.head.appendChild(style);\r\n  injected = true;\r\n\r\n  // soft starfield background (very light)\r\n  try {\r\n    const exists = document.querySelector('[data-stars]');\r\n    if (!exists) {\r\n      const cvs = document.createElement('canvas');\r\n      cvs.setAttribute('data-stars', '');\r\n      cvs.style.cssText = 'position:fixed;inset:0;z-index:-2;opacity:.40;pointer-events:none;';\r\n      document.body.appendChild(cvs);\r\n      const ctx = cvs.getContext('2d');\r\n      const stars = Array.from({ length: 80 }, () => ({ x: Math.random(), y: Math.random(), r: Math.random()*1.2+0.2, s: Math.random()*0.8+0.2 }));\r\n      type Meteor = { x: number; y: number; vx: number; vy: number; life: number; ttl: number };\r\n      const meteors: Meteor[] = [];\r\n      const spawnMeteor = () => {\r\n        const x = Math.random()*cvs.width*0.6 + cvs.width*0.2;\r\n        const y = -20; // from top\r\n        const speed = 3 + Math.random()*3;\r\n        const angle = Math.PI*0.8 + Math.random()*0.2; // diagonally\r\n        meteors.push({ x, y, vx: Math.cos(angle)*speed, vy: Math.sin(angle)*speed, life: 0, ttl: 1200 + Math.random()*800 });\r\n      };\r\n      // gentle planets/orbs\r\n      const orbs = Array.from({ length: 2 }, () => ({ x: Math.random(), y: Math.random()*0.5 + 0.1, r: Math.random()*80 + 70, hue: Math.random() }));\r\n      const fit = () => { cvs.width = window.innerWidth; cvs.height = window.innerHeight; };\r\n      fit();\r\n      window.addEventListener('resize', fit);\r\n      let t = 0;\r\n      const loop = () => {\r\n        if (!ctx) return;\r\n        t += 0.016;\r\n        ctx.clearRect(0,0,cvs.width,cvs.height);\r\n        // soft orbs\r\n        for (const ob of orbs) {\r\n          const x = ob.x * cvs.width, y = ob.y * cvs.height;\r\n          const pulse = (Math.sin(t*0.6 + x*0.0015)*0.5+0.5)*0.12;\r\n          const rad = ob.r * (1+pulse);\r\n          const grad = ctx.createRadialGradient(x, y, 0, x, y, rad);\r\n          grad.addColorStop(0, 'rgba(110,80,255,0.10)');\r\n          grad.addColorStop(1, 'rgba(0,0,0,0)');\r\n          ctx.fillStyle = grad;\r\n          ctx.beginPath();\r\n          ctx.arc(x, y, rad, 0, Math.PI*2);\r\n          ctx.fill();\r\n        }\r\n        // stars twinkle\r\n        for (const st of stars) {\r\n          const x = st.x * cvs.width, y = st.y * cvs.height;\r\n          const tw = (Math.sin(t*1.6 + x*0.002 + y*0.003)*0.5+0.5)*0.5+0.5;\r\n          ctx.beginPath();\r\n          ctx.arc(x, y, st.r + tw*0.6, 0, Math.PI*2);\r\n          ctx.fillStyle = 'rgba(180,200,255,0.6)';\r\n          ctx.fill();\r\n        }\r\n        // meteors\r\n        if (Math.random() < 0.015 && meteors.length < 2) spawnMeteor();\r\n        for (let i=meteors.length-1; i>=0; i--) {\r\n          const m = meteors[i];\r\n          m.x += m.vx; m.y += m.vy; m.life += 16;\r\n          // trail\r\n          const trail = ctx.createLinearGradient(m.x, m.y, m.x - m.vx*8, m.y - m.vy*8);\r\n          trail.addColorStop(0, 'rgba(255,255,255,0.9)');\r\n          trail.addColorStop(1, 'rgba(150,180,255,0)');\r\n          ctx.strokeStyle = trail;\r\n          ctx.lineWidth = 2;\r\n          ctx.beginPath();\r\n          ctx.moveTo(m.x - m.vx*10, m.y - m.vy*10);\r\n          ctx.lineTo(m.x, m.y);\r\n          ctx.stroke();\r\n          if (m.y > cvs.height + 40 || m.x < -40 || m.x > cvs.width + 40 || m.life > m.ttl) {\r\n            meteors.splice(i,1);\r\n          }\r\n        }\r\n        requestAnimationFrame(loop);\r\n      };\r\n      requestAnimationFrame(loop);\r\n    }\r\n  } catch {}\r\n}\r\n", "import { LoginScene } from './scenes/LoginScene';\nimport { MainScene } from './scenes/MainScene';\nimport { GameManager } from './core/GameManager';\nimport { WarehouseScene } from './scenes/WarehouseScene';\nimport { PlunderScene } from './scenes/PlunderScene';\nimport { ExchangeScene } from './scenes/ExchangeScene';\nimport { RankingScene } from './scenes/RankingScene';\nimport { ensureGlobalStyles } from './styles/inject';\n\nfunction routeTo(container: HTMLElement) {\n  const h = location.hash || '#/login';\n  const scene = h.split('?')[0];\n  switch (scene) {\n    case '#/main':\n      new MainScene().mount(container);\n      break;\n    case '#/warehouse':\n      new WarehouseScene().mount(container);\n      break;\n    case '#/plunder':\n      new PlunderScene().mount(container);\n      break;\n    case '#/exchange':\n      new ExchangeScene().mount(container);\n      break;\n    case '#/ranking':\n      new RankingScene().mount(container);\n      break;\n    default:\n      new LoginScene().mount(container);\n  }\n}\n\nexport async function bootstrap(container: HTMLElement) {\n  ensureGlobalStyles();\n  routeTo(container);\n  window.onhashchange = () => routeTo(container);\n}\n\n// \u4FBF\u6377\u542F\u52A8\uFF08\u7F51\u9875\u73AF\u5883\uFF09\nif (typeof window !== 'undefined') {\n  (window as any).MinerApp = { bootstrap, GameManager };\n}\n\r\n\r\n"],
  "mappings": "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",
  "names": ["view", "view", "view", "view", "view", "view", "grad"]
}
