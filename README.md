# ğŸ® Miner Game - çŸ¿å·¥æ¸¸æˆ

ä¸€ä¸ªåŸºäº Web çš„å¤šäººåœ¨çº¿æŒ–çŸ¿æ¸¸æˆï¼ŒåŒ…å«æŒ–çŸ¿ã€æ å¤ºã€äº¤æ˜“ã€æ’è¡Œæ¦œç­‰æ ¸å¿ƒç©æ³•ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªå…¨æ ˆ Web æ¸¸æˆé¡¹ç›®ï¼Œç©å®¶å¯ä»¥é€šè¿‡æŒ–çŸ¿è·å–èµ„æºï¼Œä¸å…¶ä»–ç©å®¶è¿›è¡Œæ å¤ºæˆ˜æ–—ï¼Œåœ¨äº¤æ˜“æ‰€å…‘æ¢èµ„æºï¼Œå¹¶é€šè¿‡æ’è¡Œæ¦œç«äº‰ã€‚æ¸¸æˆé‡‡ç”¨å®æ—¶é€šä¿¡æŠ€æœ¯ï¼Œæä¾›æµç•…çš„æ¸¸æˆä½“éªŒã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ” ç”¨æˆ·ç³»ç»Ÿ
- ç”¨æˆ·æ³¨å†Œä¸ç™»å½•
- JWT èº«ä»½è®¤è¯
- æ˜µç§°ä¿®æ”¹
- ç”¨æˆ·èµ„æ–™ç®¡ç†

### â›ï¸ æŒ–çŸ¿ç³»ç»Ÿ
- å¼€å§‹/åœæ­¢æŒ–çŸ¿
- å®æ—¶çŸ¿è½¦è¿›åº¦æ›´æ–°
- æ”¶é›†çŸ¿çŸ³
- çŸ¿æ´å´©å¡Œæœºåˆ¶

### âš”ï¸ æ å¤ºç³»ç»Ÿ
- ç©å®¶é—´èµ„æºæ å¤º
- å®æ—¶æˆ˜æ–—é€šçŸ¥
- é˜²å¾¡æœºåˆ¶

### ğŸ’± äº¤æ˜“æ‰€
- çŸ¿çŸ³å…‘æ¢ BB å¸
- å®æ—¶æ±‡ç‡ç³»ç»Ÿ

### ğŸ“¦ ä»“åº“ç³»ç»Ÿ
- ç‰©å“ç®¡ç†
- ç¢ç‰‡åˆæˆ

### ğŸ† æ’è¡Œæ¦œ
- å…¨æœç©å®¶æ’å
- å¤šç»´åº¦æ’åº

### ğŸ“¢ å®æ—¶é€šçŸ¥
- WebSocket å®æ—¶æ¨é€
- æ¸¸æˆäº‹ä»¶é€šçŸ¥
- æ å¤ºæé†’

### ğŸ å¹¿å‘Šç³»ç»Ÿ
- è§‚çœ‹å¹¿å‘Šè·å¾—å¥–åŠ±

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: NestJS 11.x
- **æ•°æ®åº“**: PostgreSQL + TypeORM
- **è®¤è¯**: JWT + Passport
- **å®æ—¶é€šä¿¡**: Socket.IO
- **è¯­è¨€**: TypeScript

### å‰ç«¯
- **è¯­è¨€**: TypeScript
- **æ„å»ºå·¥å…·**: esbuild
- **å®æ—¶é€šä¿¡**: Socket.IO Client
- **æ¶æ„**: æ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
miner-game/
â”œâ”€â”€ backend/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ user/           # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ gameplay/       # æ¸¸æˆç©æ³•æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ mine/       # æŒ–çŸ¿ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ plunder/    # æ å¤ºç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ exchange/       # äº¤æ˜“æ‰€æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ item/           # é“å…·ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ ranking/        # æ’è¡Œæ¦œæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ notification/   # å®æ—¶é€šçŸ¥
â”‚   â”‚   â”œâ”€â”€ database/       # æ•°æ®åº“é…ç½®
â”‚   â”‚   â””â”€â”€ shared/         # å…±äº«å·¥å…·
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ frontend-scripts/        # å‰ç«¯ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ components/         # UI ç»„ä»¶
â”‚   â”œâ”€â”€ scenes/             # æ¸¸æˆåœºæ™¯
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒç®¡ç†å™¨
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ web/                    # å‰ç«¯é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ app.js              # æ‰“åŒ…åçš„ JS
â”œâ”€â”€ dev-server.js           # å¼€å‘æœåŠ¡å™¨
â””â”€â”€ package.json
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.x
- PostgreSQL >= 14.x
- npm >= 9.x

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd miner-game
```

2. **é…ç½®æ•°æ®åº“**

åˆ›å»º PostgreSQL æ•°æ®åº“ï¼š
```sql
CREATE DATABASE miner_game;
```

3. **é…ç½®ç¯å¢ƒå˜é‡**

åœ¨ `backend` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_password
DB_DATABASE=miner_game

# JWT é…ç½®
JWT_SECRET=your_jwt_secret_key_here

# æœåŠ¡ç«¯å£
PORT=3002
```

4. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬ï¼š
```bash
npm run dev
```

è¿™å°†è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š
- å®‰è£…åç«¯ä¾èµ–
- å¯åŠ¨ NestJS åç«¯æœåŠ¡ (ç«¯å£ 3002)
- å®æ—¶ç¼–è¯‘å‰ç«¯ TypeScript ä»£ç 
- å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ (ç«¯å£ 5173)
- é…ç½® API ä»£ç†

5. **è®¿é—®æ¸¸æˆ**

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5173`

## ğŸ® æ¸¸æˆç©æ³•

### 1. æ³¨å†Œ/ç™»å½•
- è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
- ç³»ç»Ÿè‡ªåŠ¨æ³¨å†Œæˆ–ç™»å½•

### 2. å¼€å§‹æŒ–çŸ¿
- ç‚¹å‡»"å¼€å§‹æŒ–çŸ¿"æŒ‰é’®
- çŸ¿è½¦è‡ªåŠ¨å¡«å……çŸ¿çŸ³
- è¾¾åˆ°ä¸€å®šå®¹é‡åç‚¹å‡»"æ”¶çŸ¿"

### 3. äº¤æ˜“èµ„æº
- åœ¨äº¤æ˜“æ‰€å°†çŸ¿çŸ³å…‘æ¢ä¸º BB å¸
- å®æ—¶æ±‡ç‡æµ®åŠ¨

### 4. æ å¤ºå…¶ä»–ç©å®¶
- é€‰æ‹©ç›®æ ‡ç©å®¶
- å‘èµ·æ å¤ºæ”»å‡»
- è·å–å¯¹æ–¹çš„èµ„æº

### 5. æŸ¥çœ‹æ’è¡Œæ¦œ
- æŸ¥çœ‹å…¨æœç©å®¶æ’å
- ç«äº‰æ›´é«˜æ’å

## ğŸ“¡ API æ–‡æ¡£

### è®¤è¯æ¥å£
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•

### ç”¨æˆ·æ¥å£
- `GET /api/user/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PATCH /api/user/nickname` - ä¿®æ”¹æ˜µç§°

### æŒ–çŸ¿æ¥å£
- `POST /api/mine/start` - å¼€å§‹æŒ–çŸ¿
- `POST /api/mine/stop` - åœæ­¢æŒ–çŸ¿
- `POST /api/mine/collect` - æ”¶é›†çŸ¿çŸ³
- `GET /api/mine/cart` - è·å–çŸ¿è½¦çŠ¶æ€

### æ å¤ºæ¥å£
- `POST /api/plunder/attack` - å‘èµ·æ å¤º
- `GET /api/plunder/targets` - è·å–å¯æ å¤ºç›®æ ‡

### äº¤æ˜“æ‰€æ¥å£
- `POST /api/exchange/ore-to-coin` - çŸ¿çŸ³å…‘æ¢ BB å¸
- `GET /api/exchange/rate` - è·å–å½“å‰æ±‡ç‡

### æ’è¡Œæ¦œæ¥å£
- `GET /api/ranking` - è·å–æ’è¡Œæ¦œ

## ğŸ”Œ WebSocket äº‹ä»¶

è¿æ¥åœ°å€ï¼š`ws://localhost:3002/game`

### å®¢æˆ·ç«¯ç›‘å¬äº‹ä»¶
- `mine.update` - æŒ–çŸ¿è¿›åº¦æ›´æ–°
- `mine.collapse` - çŸ¿æ´å´©å¡Œ
- `plunder.attacked` - è¢«æ å¤ºé€šçŸ¥

## ğŸ”§ å¼€å‘å‘½ä»¤

### æ ¹ç›®å½•
```bash
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build:web        # æ„å»ºå‰ç«¯ä»£ç 
```

### åç«¯ç›®å½• (backend/)
```bash
npm run start:dev        # å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨
npm run start:prod       # ç”Ÿäº§æ¨¡å¼å¯åŠ¨
npm run build            # æ„å»ºåç«¯
npm run test             # è¿è¡Œæµ‹è¯•
npm run lint             # ä»£ç æ£€æŸ¥
npm run format           # ä»£ç æ ¼å¼åŒ–
```

## ğŸ“ æ•°æ®åº“è¿ç§»

```bash
cd backend
npm run typeorm migration:generate -- src/database/migrations/MigrationName
npm run typeorm migration:run
npm run typeorm migration:revert
```

## ğŸ¨ å‰ç«¯æ¶æ„

### æ ¸å¿ƒç®¡ç†å™¨
- **GameManager**: æ¸¸æˆçŠ¶æ€ç®¡ç†
- **NetworkManager**: ç½‘ç»œè¯·æ±‚ç®¡ç†
- **RealtimeClient**: WebSocket è¿æ¥ç®¡ç†
- **ThemeManager**: ä¸»é¢˜æ ·å¼ç®¡ç†

### åœºæ™¯ç³»ç»Ÿ
- **LoginScene**: ç™»å½•åœºæ™¯
- **MainScene**: ä¸»ç•Œé¢åœºæ™¯
- **PlunderScene**: æ å¤ºåœºæ™¯
- **ExchangeScene**: äº¤æ˜“æ‰€åœºæ™¯
- **RankingScene**: æ’è¡Œæ¦œåœºæ™¯
- **WarehouseScene**: ä»“åº“åœºæ™¯

### UI ç»„ä»¶
- åŠ¨ç”»å›¾æ ‡ã€æµ®åŠ¨æ–‡å­—ã€è¿›åº¦æ¡
- èµ„æºå¡ç‰‡ã€æŒ–çŸ¿å¡ç‰‡
- Toast æç¤ºã€å¹¿å‘Šå¼¹çª—

## ğŸ” å®‰å…¨ç‰¹æ€§

- JWT Token è®¤è¯
- å¯†ç  bcrypt åŠ å¯†
- è¯·æ±‚å‚æ•°éªŒè¯
- å…¨å±€å¼‚å¸¸å¤„ç†
- API é€Ÿç‡é™åˆ¶

## ğŸ› è°ƒè¯•

### æŸ¥çœ‹åç«¯æ—¥å¿—
åç«¯æ—¥å¿—ä¼šç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œæ ‡è®°ä¸º `[backend]`

### æŸ¥çœ‹å‰ç«¯æ„å»º
å‰ç«¯æ„å»ºæ—¥å¿—ä¼šè¾“å‡º esbuild çš„ç¼–è¯‘çŠ¶æ€

### æµè§ˆå™¨è°ƒè¯•
æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹ï¼š
- ç½‘ç»œè¯·æ±‚
- WebSocket è¿æ¥
- æ§åˆ¶å°æ—¥å¿—

## ğŸ“„ License

[MIT License](LICENSE)

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“® è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘é€é‚®ä»¶

---

**Happy Mining! â›ï¸ğŸ’**